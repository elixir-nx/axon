<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.2">
    <meta name="project" content="Axon v0.7.0">


    <title>Axon â€” Axon v0.7.0</title>
    <link rel="stylesheet" href="dist/html-elixir-F2VRIOKR.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-02629AA9.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-YIPIRHGU.js"></script>

  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="Axon.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Axon" />
        </a>

      <div>
        <a href="Axon.html" class="sidebar-projectName" translate="no">
Axon
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.7.0
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Axon</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

    <span translate="no">Axon</span> 
    <small class="app-vsn" translate="no">(Axon v0.7.0)</small>

  </h1>


    <section id="moduledoc">
<p>A high-level interface for creating neural network models.</p><p>Axon is built entirely on top of Nx numerical definitions,
so every neural network can be JIT or AOT compiled using
any Nx compiler, or even transformed into high-level neural
network formats like TensorFlow Lite and
<a href="https://github.com/elixir-nx/axon_onnx">ONNX</a>.</p><p>For a more in-depth overview of Axon, refer to the <a href="guides.html">Guides</a>.</p><h2 id="module-model-creation" class="section-heading">
  <a href="#module-model-creation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Model Creation</span>
</h2>
<p>All Axon models start with an input layer, optionally specifying
the expected shape of the input data:</p><pre><code class="makeup elixir" translate="no"><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="9015989497-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9015989497-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="9015989497-2">}</span><span class="p" data-group-id="9015989497-1">)</span></code></pre><p>Notice you can specify some dimensions as <code class="inline">nil</code>, indicating
that the dimension size will be filled in at model runtime.
You can then compose inputs with other layers:</p><pre><code class="makeup elixir" translate="no"><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">input</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4241707750-1">(</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="ss">activation</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="4241707750-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">batch_norm</span><span class="p" data-group-id="4241707750-2">(</span><span class="p" data-group-id="4241707750-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dropout</span><span class="p" data-group-id="4241707750-3">(</span><span class="ss">rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p" data-group-id="4241707750-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4241707750-4">(</span><span class="mi">64</span><span class="p" data-group-id="4241707750-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">tanh</span><span class="p" data-group-id="4241707750-5">(</span><span class="p" data-group-id="4241707750-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4241707750-6">(</span><span class="mi">10</span><span class="p" data-group-id="4241707750-6">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">activation</span><span class="p" data-group-id="4241707750-7">(</span><span class="ss">:softmax</span><span class="p" data-group-id="4241707750-7">)</span></code></pre><p>You can inspect the model for a nice summary:</p><pre><code class="makeup elixir" translate="no"><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="p" data-group-id="3794802507-1">(</span><span class="n">model</span><span class="p" data-group-id="3794802507-1">)</span><span class="w">

</span><span class="p" data-group-id="3794802507-2">#</span><span class="nc" data-group-id="3794802507-2">Axon</span><span class="p" data-group-id="3794802507-2">&lt;</span><span class="w">
  </span><span class="ss">inputs</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3794802507-3">%{</span><span class="s">&quot;input&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="3794802507-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="3794802507-4">}</span><span class="p" data-group-id="3794802507-3">}</span><span class="w">
  </span><span class="ss">outputs</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;softmax_0&quot;</span><span class="w">
  </span><span class="ss">nodes</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="w">
</span><span class="p" data-group-id="3794802507-2">&gt;</span></code></pre><p>Or use the <a href="Axon.Display.html"><code class="inline">Axon.Display</code></a> module to see more in-depth summaries:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon.Display</span><span class="o">.</span><span class="n">as_table</span><span class="p" data-group-id="2371795254-1">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="2371795254-2">(</span><span class="p" data-group-id="2371795254-3">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="2371795254-3">}</span><span class="p">,</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="2371795254-2">)</span><span class="p" data-group-id="2371795254-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="w">

</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w">                                                     </span><span class="nc">Model</span><span class="w">                                                      </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">=</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">==</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">=</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">==</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="nc">Layer</span><span class="w">                                 </span><span class="o">|</span><span class="w"> </span><span class="nc">Input</span><span class="w"> </span><span class="nc">Shape</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">Output</span><span class="w"> </span><span class="nc">Shape</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nc">Options</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="nc">Parameters</span><span class="w">            </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">=</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">==</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">=</span><span class="o">+</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">===</span><span class="o">==</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="p" data-group-id="2371795254-4">(</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="p" data-group-id="2371795254-4">)</span><span class="w">                       </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-5">[</span><span class="p" data-group-id="2371795254-5">]</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-6">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="2371795254-6">}</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2371795254-7">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="2371795254-7">}</span><span class="w"> </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="ss">optional</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">   </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">dense_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-8">(</span><span class="w"> </span><span class="n">dense</span><span class="p" data-group-id="2371795254-9">[</span><span class="s">&quot;input&quot;</span><span class="p" data-group-id="2371795254-9">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-8">)</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-10">[</span><span class="p" data-group-id="2371795254-11">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="2371795254-11">}</span><span class="p" data-group-id="2371795254-10">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-12">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-12">}</span><span class="w">     </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">kernel</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-13">[</span><span class="mi">784</span><span class="p" data-group-id="2371795254-13">]</span><span class="p" data-group-id="2371795254-14">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-14">]</span><span class="w"> </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">bias</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-15">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-15">]</span><span class="w">        </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">relu_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-16">(</span><span class="w"> </span><span class="n">relu</span><span class="p" data-group-id="2371795254-17">[</span><span class="s">&quot;dense_0&quot;</span><span class="p" data-group-id="2371795254-17">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-16">)</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-18">[</span><span class="p" data-group-id="2371795254-19">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-19">}</span><span class="p" data-group-id="2371795254-18">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-20">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-20">}</span><span class="w">     </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">batch_norm_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-21">(</span><span class="w"> </span><span class="n">batch_norm</span><span class="p" data-group-id="2371795254-22">[</span><span class="s">&quot;relu_0&quot;</span><span class="p" data-group-id="2371795254-22">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-21">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-23">[</span><span class="p" data-group-id="2371795254-24">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-24">}</span><span class="p" data-group-id="2371795254-23">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-25">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-25">}</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="ss">epsilon</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0e-5</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="ss">gamma</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-26">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-26">]</span><span class="w">       </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="ss">channel_index</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="ss">beta</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-27">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-27">]</span><span class="w">        </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="ss">momentum</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="ss">mean</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-28">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-28">]</span><span class="w">        </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">var</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-29">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-29">]</span><span class="w">         </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">dropout_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-30">(</span><span class="w"> </span><span class="n">dropout</span><span class="p" data-group-id="2371795254-31">[</span><span class="s">&quot;batch_norm_0&quot;</span><span class="p" data-group-id="2371795254-31">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-30">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-32">[</span><span class="p" data-group-id="2371795254-33">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-33">}</span><span class="p" data-group-id="2371795254-32">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-34">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-34">}</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="ss">rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="w">         </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">dense_1</span><span class="w"> </span><span class="p" data-group-id="2371795254-35">(</span><span class="w"> </span><span class="n">dense</span><span class="p" data-group-id="2371795254-36">[</span><span class="s">&quot;dropout_0&quot;</span><span class="p" data-group-id="2371795254-36">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-35">)</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-37">[</span><span class="p" data-group-id="2371795254-38">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p" data-group-id="2371795254-38">}</span><span class="p" data-group-id="2371795254-37">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-39">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p" data-group-id="2371795254-39">}</span><span class="w">      </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">kernel</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-40">[</span><span class="mi">128</span><span class="p" data-group-id="2371795254-40">]</span><span class="p" data-group-id="2371795254-41">[</span><span class="mi">64</span><span class="p" data-group-id="2371795254-41">]</span><span class="w">  </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">bias</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-42">[</span><span class="mi">64</span><span class="p" data-group-id="2371795254-42">]</span><span class="w">         </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">tanh_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-43">(</span><span class="w"> </span><span class="n">tanh</span><span class="p" data-group-id="2371795254-44">[</span><span class="s">&quot;dense_1&quot;</span><span class="p" data-group-id="2371795254-44">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-43">)</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-45">[</span><span class="p" data-group-id="2371795254-46">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p" data-group-id="2371795254-46">}</span><span class="p" data-group-id="2371795254-45">]</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-47">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p" data-group-id="2371795254-47">}</span><span class="w">      </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">dense_2</span><span class="w"> </span><span class="p" data-group-id="2371795254-48">(</span><span class="w"> </span><span class="n">dense</span><span class="p" data-group-id="2371795254-49">[</span><span class="s">&quot;tanh_0&quot;</span><span class="p" data-group-id="2371795254-49">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-48">)</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-50">[</span><span class="p" data-group-id="2371795254-51">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p" data-group-id="2371795254-51">}</span><span class="p" data-group-id="2371795254-50">]</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-52">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="2371795254-52">}</span><span class="w">      </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">kernel</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-53">[</span><span class="mi">64</span><span class="p" data-group-id="2371795254-53">]</span><span class="p" data-group-id="2371795254-54">[</span><span class="mi">10</span><span class="p" data-group-id="2371795254-54">]</span><span class="w">   </span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="ss">bias</span><span class="p">:</span><span class="w"> </span><span class="n">f32</span><span class="p" data-group-id="2371795254-55">[</span><span class="mi">10</span><span class="p" data-group-id="2371795254-55">]</span><span class="w">         </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="n">softmax_0</span><span class="w"> </span><span class="p" data-group-id="2371795254-56">(</span><span class="w"> </span><span class="n">softmax</span><span class="p" data-group-id="2371795254-57">[</span><span class="s">&quot;dense_2&quot;</span><span class="p" data-group-id="2371795254-57">]</span><span class="w"> </span><span class="p" data-group-id="2371795254-56">)</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-58">[</span><span class="p" data-group-id="2371795254-59">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="2371795254-59">}</span><span class="p" data-group-id="2371795254-58">]</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="2371795254-60">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="2371795254-60">}</span><span class="w">      </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span></code></pre><h3 id="module-multiple-inputs" class="section-heading">
  <a href="#module-multiple-inputs" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Multiple Inputs</span>
</h3>
<p>Creating a model with multiple inputs is as easy as declaring an
additional input in your Axon graph. Every input layer present in
the final Axon graph will be required to be passed as input at the
time of model execution.</p><pre><code class="makeup elixir" translate="no"><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8484507892-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8484507892-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8484507892-2">}</span><span class="p" data-group-id="8484507892-1">)</span><span class="w">
</span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8484507892-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8484507892-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8484507892-4">}</span><span class="p" data-group-id="8484507892-3">)</span><span class="w">

</span><span class="c1"># Both inputs will be used</span><span class="w">
</span><span class="n">model1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="8484507892-5">(</span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="8484507892-5">)</span><span class="w">

</span><span class="c1"># Only inp2 will be used</span><span class="w">
</span><span class="n">model2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="8484507892-6">(</span><span class="n">inp2</span><span class="p">,</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="8484507892-6">)</span></code></pre><p>Axon graphs are immutable, which means composing and manipulating
an Axon graph creates an entirely new graph. Additionally, layer
names are lazily generated at model execution time. To avoid
non-deterministic input orderings and names, Axon requires each
input to have a unique binary identifier. You can then reference
inputs by name when passing to models at execution time:</p><pre><code class="makeup elixir" translate="no"><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4423120719-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4423120719-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4423120719-2">}</span><span class="p" data-group-id="4423120719-1">)</span><span class="w">
</span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4423120719-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4423120719-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4423120719-4">}</span><span class="p" data-group-id="4423120719-3">)</span><span class="w">

</span><span class="n">model1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="4423120719-5">(</span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="4423120719-5">)</span><span class="w">

</span><span class="p" data-group-id="4423120719-6">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="4423120719-6">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="4423120719-7">(</span><span class="n">model1</span><span class="p" data-group-id="4423120719-7">)</span><span class="w">

</span><span class="n">params1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="4423120719-8">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="4423120719-9">(</span><span class="p" data-group-id="4423120719-10">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4423120719-10">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4423120719-11">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4423120719-11">}</span><span class="p" data-group-id="4423120719-9">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4423120719-12">%{</span><span class="p" data-group-id="4423120719-12">}</span><span class="p" data-group-id="4423120719-8">)</span><span class="w">
</span><span class="c1"># Inputs are referenced by name</span><span class="w">
</span><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="4423120719-13">(</span><span class="n">params1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4423120719-14">%{</span><span class="s">&quot;input_0&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;input_1&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">y</span><span class="p" data-group-id="4423120719-14">}</span><span class="p" data-group-id="4423120719-13">)</span></code></pre><h3 id="module-multiple-outputs" class="section-heading">
  <a href="#module-multiple-outputs" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Multiple Outputs</span>
</h3>
<p>Nx offers robust <a href="https://hexdocs.pm/nx/Nx.Container.html">container</a> support
which is extended to Axon. Axon allows you to wrap any valid Nx container
in a layer. Containers are most commonly used to structure outputs:</p><pre><code class="makeup elixir" translate="no"><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="0091304027-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0091304027-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0091304027-2">}</span><span class="p" data-group-id="0091304027-1">)</span><span class="w">
</span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="0091304027-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0091304027-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="0091304027-4">}</span><span class="p" data-group-id="0091304027-3">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">container</span><span class="p" data-group-id="0091304027-5">(</span><span class="p" data-group-id="0091304027-6">%{</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="ss">bar</span><span class="p">:</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="0091304027-6">}</span><span class="p" data-group-id="0091304027-5">)</span></code></pre><p>Containers can be arbitrarily nested:</p><pre><code class="makeup elixir" translate="no"><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8614264523-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8614264523-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8614264523-2">}</span><span class="p" data-group-id="8614264523-1">)</span><span class="w">
</span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8614264523-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8614264523-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8614264523-4">}</span><span class="p" data-group-id="8614264523-3">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">container</span><span class="p" data-group-id="8614264523-5">(</span><span class="p" data-group-id="8614264523-6">{</span><span class="p" data-group-id="8614264523-7">%{</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8614264523-8">{</span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8614264523-9">%{</span><span class="ss">bar</span><span class="p">:</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="8614264523-9">}</span><span class="p" data-group-id="8614264523-8">}</span><span class="p" data-group-id="8614264523-7">}</span><span class="p" data-group-id="8614264523-6">}</span><span class="p" data-group-id="8614264523-5">)</span></code></pre><p>You can even use custom structs which implement the container protocol:</p><pre><code class="makeup elixir" translate="no"><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="1006866517-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1006866517-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1006866517-2">}</span><span class="p" data-group-id="1006866517-1">)</span><span class="w">
</span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="1006866517-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1006866517-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1006866517-4">}</span><span class="p" data-group-id="1006866517-3">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">container</span><span class="p" data-group-id="1006866517-5">(</span><span class="p" data-group-id="1006866517-6">%</span><span class="nc" data-group-id="1006866517-6">MyStruct</span><span class="p" data-group-id="1006866517-6">{</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="ss">bar</span><span class="p">:</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="1006866517-6">}</span><span class="p" data-group-id="1006866517-5">)</span></code></pre><h3 id="module-custom-layers" class="section-heading">
  <a href="#module-custom-layers" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Custom Layers</span>
</h3>
<p>If you find that Axon's built-in layers are insufficient for your needs,
you can create your own using the custom layer API. All of Axon's built-in
layers (aside from special ones such as <code class="inline">input</code>, <code class="inline">constant</code>, and <code class="inline">container</code>)
make use of this same API.</p><p>Axon layers are really just placeholders for Nx computations with trainable
parameters and possibly state. To define a custom layer, you just need to
define a <code class="inline">defn</code> implementation:</p><pre><code class="makeup elixir" translate="no"><span class="kd">defn</span><span class="w"> </span><span class="nf">my_layer</span><span class="p" data-group-id="3394312872-1">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="c">_opts</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="p" data-group-id="3394312872-2">[</span><span class="p" data-group-id="3394312872-2">]</span><span class="p" data-group-id="3394312872-1">)</span><span class="w"> </span><span class="k" data-group-id="3394312872-3">do</span><span class="w">
  </span><span class="nc">Nx</span><span class="o">.</span><span class="n">atan2</span><span class="p" data-group-id="3394312872-4">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p" data-group-id="3394312872-4">)</span><span class="w">
</span><span class="k" data-group-id="3394312872-3">end</span></code></pre><p>Notice the only stipulation is that your custom layer implementation must
accept at least 1 input and a list of options. At execution time, every
layer will be passed a <code class="inline">:mode</code> option which can be used to control behavior
at training and inference time.</p><p>Inputs to your custom layer can be either Axon graph inputs or trainable
parameters. You can pass Axon graph inputs as-is to a custom layer. To
declare trainable parameters, use <a href="#param/3"><code class="inline">Axon.param/3</code></a>:</p><pre><code class="makeup elixir" translate="no"><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">param</span><span class="p" data-group-id="7961833414-1">(</span><span class="s">&quot;weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">param_shape</span><span class="p" data-group-id="7961833414-1">)</span></code></pre><p>To create a custom layer, you &quot;wrap&quot; your implementation and inputs into
a layer using <code class="inline">Axon.layer</code>. You'll notice the API mirrors Elixir's <code class="inline">apply</code>:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">atan2_layer</span><span class="p" data-group-id="6060905002-1">(</span><span class="p" data-group-id="6060905002-2">%</span><span class="nc" data-group-id="6060905002-2">Axon</span><span class="p" data-group-id="6060905002-2">{</span><span class="p" data-group-id="6060905002-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p" data-group-id="6060905002-1">)</span><span class="w"> </span><span class="k" data-group-id="6060905002-3">do</span><span class="w">
  </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">param</span><span class="p" data-group-id="6060905002-4">(</span><span class="s">&quot;weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">param_shape</span><span class="p" data-group-id="6060905002-4">)</span><span class="w">
  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">layer</span><span class="p" data-group-id="6060905002-5">(</span><span class="o">&amp;</span><span class="n">my_layer</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6060905002-6">[</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p" data-group-id="6060905002-6">]</span><span class="p" data-group-id="6060905002-5">)</span><span class="w">
</span><span class="k" data-group-id="6060905002-3">end</span></code></pre><h2 id="module-model-execution" class="section-heading">
  <a href="#module-model-execution" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Model Execution</span>
</h2>
<p>Under the hood, Axon models are represented as Elixir structs. You
can initialize and apply models by building or compiling them with
<a href="#build/2"><code class="inline">Axon.build/2</code></a> or <a href="#compile/4"><code class="inline">Axon.compile/4</code></a> and then calling the produced
initialization and predict functions:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="4375304256-1">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="4375304256-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="4375304256-2">(</span><span class="n">model</span><span class="p" data-group-id="4375304256-2">)</span><span class="w">

</span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="4375304256-3">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="4375304256-4">(</span><span class="p" data-group-id="4375304256-5">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4375304256-5">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4375304256-6">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="4375304256-6">}</span><span class="p" data-group-id="4375304256-4">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4375304256-7">%{</span><span class="p" data-group-id="4375304256-7">}</span><span class="p" data-group-id="4375304256-3">)</span><span class="w">
</span><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="4375304256-8">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">inputs</span><span class="p" data-group-id="4375304256-8">)</span></code></pre><p>You may either set the default JIT compiler or backend globally, or
pass a specific compiler to <a href="#build/2"><code class="inline">Axon.build/2</code></a>:</p><pre><code class="makeup elixir" translate="no"><span class="nc">EXLA</span><span class="o">.</span><span class="n">set_as_nx_default</span><span class="p" data-group-id="2077182368-1">(</span><span class="p" data-group-id="2077182368-2">[</span><span class="ss">:tpu</span><span class="p">,</span><span class="w"> </span><span class="ss">:cuda</span><span class="p">,</span><span class="w"> </span><span class="ss">:rocm</span><span class="p">,</span><span class="w"> </span><span class="ss">:host</span><span class="p" data-group-id="2077182368-2">]</span><span class="p" data-group-id="2077182368-1">)</span><span class="w">

</span><span class="p" data-group-id="2077182368-3">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="2077182368-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="2077182368-4">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="ss">compiler</span><span class="p">:</span><span class="w"> </span><span class="nc">EXLA</span><span class="p">,</span><span class="w"> </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:train</span><span class="p" data-group-id="2077182368-4">)</span><span class="w">

</span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="2077182368-5">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="2077182368-6">(</span><span class="p" data-group-id="2077182368-7">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="2077182368-7">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2077182368-8">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="2077182368-8">}</span><span class="p" data-group-id="2077182368-6">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2077182368-9">%{</span><span class="p" data-group-id="2077182368-9">}</span><span class="p" data-group-id="2077182368-5">)</span><span class="w">
</span><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="2077182368-10">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">inputs</span><span class="p" data-group-id="2077182368-10">)</span></code></pre><p><code class="inline">predict_fn</code> by default runs in inference mode, which performs certain
optimizations and removes layers such as dropout layers. If constructing
a training step using <a href="#predict/4"><code class="inline">Axon.predict/4</code></a> or <a href="#build/2"><code class="inline">Axon.build/2</code></a>, be sure to specify
<code class="inline">mode: :train</code>.</p><h2 id="module-model-training" class="section-heading">
  <a href="#module-model-training" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Model Training</span>
</h2>
<p>Combining the Axon model creation API with the optimization and training
APIs, you can create and train neural networks with ease:</p><pre><code class="makeup elixir" translate="no"><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4215510217-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4215510217-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">784</span><span class="p" data-group-id="4215510217-2">}</span><span class="p" data-group-id="4215510217-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4215510217-3">(</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="ss">activation</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="4215510217-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">layer_norm</span><span class="p" data-group-id="4215510217-4">(</span><span class="p" data-group-id="4215510217-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dropout</span><span class="p" data-group-id="4215510217-5">(</span><span class="p" data-group-id="4215510217-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4215510217-6">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">activation</span><span class="p">:</span><span class="w"> </span><span class="ss">:softmax</span><span class="p" data-group-id="4215510217-6">)</span><span class="w">

</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="w"> </span><span class="n">model</span><span class="w">

</span><span class="n">model_state</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">model</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">trainer</span><span class="p" data-group-id="4215510217-7">(</span><span class="ss">:categorical_cross_entropy</span><span class="p">,</span><span class="w"> </span><span class="nc">Polaris.Optimizers</span><span class="o">.</span><span class="n">adamw</span><span class="p" data-group-id="4215510217-8">(</span><span class="ss">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.005</span><span class="p" data-group-id="4215510217-8">)</span><span class="p" data-group-id="4215510217-7">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">run</span><span class="p" data-group-id="4215510217-9">(</span><span class="n">train_data</span><span class="p">,</span><span class="w"> </span><span class="ss">epochs</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">compiler</span><span class="p">:</span><span class="w"> </span><span class="nc">EXLA</span><span class="p" data-group-id="4215510217-9">)</span></code></pre><p>See <a href="https://hexdocs.pm/polaris/0.1.0/Polaris.Updates.html"><code class="inline">Polaris.Updates</code></a> and <a href="Axon.Loop.html"><code class="inline">Axon.Loop</code></a> for a more in-depth treatment of
model optimization and model training.</p><h2 id="module-using-with-nx-serving" class="section-heading">
  <a href="#module-using-with-nx-serving" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Using with <a href="https://hexdocs.pm/nx/0.9.0/Nx.Serving.html"><code class="inline">Nx.Serving</code></a></span>
</h2>
<p>When deploying an <a href="Axon.html"><code class="inline">Axon</code></a> model to production, you usually want to batch
multiple prediction requests and run the inference for all of them at
once. Conveniently, <a href="https://hexdocs.pm/nx/0.9.0/Nx.html"><code class="inline">Nx</code></a> already has an abstraction for this task in the
form of <a href="https://hexdocs.pm/nx/0.9.0/Nx.Serving.html"><code class="inline">Nx.Serving</code></a>. Here's how you could define a serving for an <a href="Axon.html"><code class="inline">Axon</code></a>
model:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_serving</span><span class="p" data-group-id="3955384861-1">(</span><span class="p" data-group-id="3955384861-1">)</span><span class="w"> </span><span class="k" data-group-id="3955384861-2">do</span><span class="w">
  </span><span class="c1"># Configuration</span><span class="w">
  </span><span class="n">batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w">
  </span><span class="n">defn_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3955384861-3">[</span><span class="ss">compiler</span><span class="p">:</span><span class="w"> </span><span class="nc">EXLA</span><span class="p" data-group-id="3955384861-3">]</span><span class="w">

  </span><span class="nc">Nx.Serving</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="3955384861-4">(</span><span class="w">
    </span><span class="c1"># This function runs on the serving startup</span><span class="w">
    </span><span class="k" data-group-id="3955384861-5">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="c1"># Build the Axon model and load params (usually from file)</span><span class="w">
      </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build_model</span><span class="p" data-group-id="3955384861-6">(</span><span class="p" data-group-id="3955384861-6">)</span><span class="w">
      </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load_params</span><span class="p" data-group-id="3955384861-7">(</span><span class="p" data-group-id="3955384861-7">)</span><span class="w">

      </span><span class="c1"># Build the prediction defn function</span><span class="w">
      </span><span class="p" data-group-id="3955384861-8">{</span><span class="c">_init_fun</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fun</span><span class="p" data-group-id="3955384861-8">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="3955384861-9">(</span><span class="n">model</span><span class="p" data-group-id="3955384861-9">)</span><span class="w">

      </span><span class="n">inputs_template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3955384861-10">%{</span><span class="s">&quot;pixel_values&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="3955384861-11">(</span><span class="p" data-group-id="3955384861-12">{</span><span class="n">batch_size</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="3955384861-12">}</span><span class="p">,</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="3955384861-11">)</span><span class="p" data-group-id="3955384861-10">}</span><span class="w">
      </span><span class="n">template_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3955384861-13">[</span><span class="nc">Nx</span><span class="o">.</span><span class="n">to_template</span><span class="p" data-group-id="3955384861-14">(</span><span class="n">params</span><span class="p" data-group-id="3955384861-14">)</span><span class="p">,</span><span class="w"> </span><span class="n">inputs_template</span><span class="p" data-group-id="3955384861-13">]</span><span class="w">

      </span><span class="c1"># Compile the prediction function upfront for the configured batch_size</span><span class="w">
      </span><span class="n">predict_fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx.Defn</span><span class="o">.</span><span class="n">compile</span><span class="p" data-group-id="3955384861-15">(</span><span class="n">predict_fun</span><span class="p">,</span><span class="w"> </span><span class="n">template_args</span><span class="p">,</span><span class="w"> </span><span class="n">defn_options</span><span class="p" data-group-id="3955384861-15">)</span><span class="w">

      </span><span class="c1"># The returned function is called for every accumulated batch</span><span class="w">
      </span><span class="k" data-group-id="3955384861-16">fn</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx.Batch</span><span class="o">.</span><span class="n">pad</span><span class="p" data-group-id="3955384861-17">(</span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="n">batch_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">inputs</span><span class="o">.</span><span class="n">size</span><span class="p" data-group-id="3955384861-17">)</span><span class="w">
        </span><span class="n">predict_fun</span><span class="o">.</span><span class="p" data-group-id="3955384861-18">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">inputs</span><span class="p" data-group-id="3955384861-18">)</span><span class="w">
      </span><span class="k" data-group-id="3955384861-16">end</span><span class="w">
    </span><span class="k" data-group-id="3955384861-5">end</span><span class="p">,</span><span class="w">
    </span><span class="ss">batch_size</span><span class="p">:</span><span class="w"> </span><span class="n">batch_size</span><span class="w">
  </span><span class="p" data-group-id="3955384861-4">)</span><span class="w">
</span><span class="k" data-group-id="3955384861-2">end</span></code></pre><p>Then you would start the serving server as part of your application's
supervision tree:</p><pre><code class="makeup elixir" translate="no"><span class="n">children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="8675250619-1">[</span><span class="w">
  </span><span class="n">...</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="8675250619-2">{</span><span class="nc">Nx.Serving</span><span class="p">,</span><span class="w"> </span><span class="ss">serving</span><span class="p">:</span><span class="w"> </span><span class="n">build_serving</span><span class="p" data-group-id="8675250619-3">(</span><span class="p" data-group-id="8675250619-3">)</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="nc">MyApp.Serving</span><span class="p">,</span><span class="w"> </span><span class="ss">batch_timeout</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="8675250619-2">}</span><span class="w">
</span><span class="p" data-group-id="8675250619-1">]</span></code></pre><p>With that in place, you can now ask serving for predictions all across
your application (controllers, live views, async jobs, etc.). Having a
tensor input you would do:</p><pre><code class="makeup elixir" translate="no"><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="6389476680-1">%{</span><span class="s">&quot;pixel_values&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="6389476680-1">}</span><span class="w">
</span><span class="n">batch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx.Batch</span><span class="o">.</span><span class="n">concatenate</span><span class="p" data-group-id="6389476680-2">(</span><span class="p" data-group-id="6389476680-3">[</span><span class="n">inputs</span><span class="p" data-group-id="6389476680-3">]</span><span class="p" data-group-id="6389476680-2">)</span><span class="w">
</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx.Serving</span><span class="o">.</span><span class="n">batched_run</span><span class="p" data-group-id="6389476680-4">(</span><span class="nc">MyApp.Serving</span><span class="p">,</span><span class="w"> </span><span class="n">batch</span><span class="p" data-group-id="6389476680-4">)</span></code></pre><p>Usually you also want to do pre/post-processing of the model input/output.
You could make those preparations directly before/after <a href="https://hexdocs.pm/nx/0.9.0/Nx.Serving.html#batched_run/2"><code class="inline">Nx.Serving.batched_run/2</code></a>,
however you can also make use of <a href="https://hexdocs.pm/nx/0.9.0/Nx.Serving.html#client_preprocessing/2"><code class="inline">Nx.Serving.client_preprocessing/2</code></a> and
<a href="https://hexdocs.pm/nx/0.9.0/Nx.Serving.html#client_postprocessing/2"><code class="inline">Nx.Serving.client_postprocessing/2</code></a> to encapsulate that logic as part of
the serving.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-layers-special summary">
  <h2>
    <a href="#layers-special">Layers: Special</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#block/2" data-no-tooltip translate="no">block(fun, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Returns a function which represents a self-contained re-usable block
of operations in a neural network. All parameters in the block are
shared between every usage of the block.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#constant/2" data-no-tooltip translate="no">constant(tensor, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a constant layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#container/2" data-no-tooltip translate="no">container(container, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a container layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#input/2" data-no-tooltip translate="no">input(name, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an input layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#layer/3" data-no-tooltip translate="no">layer(op, inputs, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Custom Axon layer with given inputs.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#nx/3" data-no-tooltip translate="no">nx(input, fun, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Applies the given <a href="https://hexdocs.pm/nx/0.9.0/Nx.html"><code class="inline">Nx</code></a> expression to the input.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#optional/2" data-no-tooltip translate="no">optional(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Wraps an Axon model in an optional node.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#or_else/3" data-no-tooltip translate="no">or_else(a, b, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Implements an or else (e.g. an Elixir ||)</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#param/3" data-no-tooltip translate="no">param(name, shape, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Trainable Axon parameter used to create custom layers.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#parameter/3" data-no-tooltip translate="no">parameter(name, template, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Trainable Axon parameter used to create custom layers.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stack_columns/2" data-no-tooltip translate="no">stack_columns(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a stack columns layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-activation summary">
  <h2>
    <a href="#layers-activation">Layers: Activation</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#activation/3" data-no-tooltip translate="no">activation(x, activation, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#celu/2" data-no-tooltip translate="no">celu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Continuously-differentiable exponential linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#elu/2" data-no-tooltip translate="no">elu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Exponential linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#exp/2" data-no-tooltip translate="no">exp(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Exponential activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#gelu/2" data-no-tooltip translate="no">gelu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Gaussian error linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#hard_sigmoid/2" data-no-tooltip translate="no">hard_sigmoid(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Hard sigmoid activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#hard_silu/2" data-no-tooltip translate="no">hard_silu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Hard sigmoid weighted linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#hard_tanh/2" data-no-tooltip translate="no">hard_tanh(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Hard hyperbolic tangent activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#leaky_relu/2" data-no-tooltip translate="no">leaky_relu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Leaky rectified linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#linear/2" data-no-tooltip translate="no">linear(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Linear activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#log_sigmoid/2" data-no-tooltip translate="no">log_sigmoid(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Log-sigmoid activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#log_softmax/2" data-no-tooltip translate="no">log_softmax(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Log-softmax activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#log_sumexp/2" data-no-tooltip translate="no">log_sumexp(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Log-sumexp activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#mish/2" data-no-tooltip translate="no">mish(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Mish activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#relu6/2" data-no-tooltip translate="no">relu6(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Rectified linear unit 6 activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#relu/2" data-no-tooltip translate="no">relu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Rectified linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#selu/2" data-no-tooltip translate="no">selu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Scaled exponential linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#sigmoid/2" data-no-tooltip translate="no">sigmoid(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Sigmoid activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#silu/2" data-no-tooltip translate="no">silu(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Sigmoid weighted linear unit activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#softmax/2" data-no-tooltip translate="no">softmax(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Softmax activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#softplus/2" data-no-tooltip translate="no">softplus(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Softplus activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#softsign/2" data-no-tooltip translate="no">softsign(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Softsign activation layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#tanh/2" data-no-tooltip translate="no">tanh(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Hyperbolic tangent activation layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-linear summary">
  <h2>
    <a href="#layers-linear">Layers: Linear</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bias/2" data-no-tooltip translate="no">bias(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a bias layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bilinear/4" data-no-tooltip translate="no">bilinear(input1, input2, units, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a bilinear layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#dense/3" data-no-tooltip translate="no">dense(x, units, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a dense layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#embedding/4" data-no-tooltip translate="no">embedding(x, vocab_size, embedding_size, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an embedding layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-convolution summary">
  <h2>
    <a href="#layers-convolution">Layers: Convolution</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#conv/3" data-no-tooltip translate="no">conv(x, units, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a convolution layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#conv_transpose/3" data-no-tooltip translate="no">conv_transpose(x, units, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a transposed convolution layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#depthwise_conv/3" data-no-tooltip translate="no">depthwise_conv(x, channel_multiplier, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a depthwise convolution layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#separable_conv2d/3" data-no-tooltip translate="no">separable_conv2d(x, channel_multiplier, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a depthwise separable 2-dimensional convolution to the
network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#separable_conv3d/3" data-no-tooltip translate="no">separable_conv3d(x, channel_multiplier, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a depthwise separable 3-dimensional convolution to the
network.</p></div>

    </div>

</div>
<div class="summary-layers-dropout summary">
  <h2>
    <a href="#layers-dropout">Layers: Dropout</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#alpha_dropout/2" data-no-tooltip translate="no">alpha_dropout(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Alpha dropout layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#dropout/2" data-no-tooltip translate="no">dropout(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Dropout layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#feature_alpha_dropout/2" data-no-tooltip translate="no">feature_alpha_dropout(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Feature alpha dropout layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#spatial_dropout/2" data-no-tooltip translate="no">spatial_dropout(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Spatial dropout layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-pooling summary">
  <h2>
    <a href="#layers-pooling">Layers: Pooling</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#adaptive_avg_pool/2" data-no-tooltip translate="no">adaptive_avg_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Adaptive average pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#adaptive_lp_pool/2" data-no-tooltip translate="no">adaptive_lp_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Adaptive power average pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#adaptive_max_pool/2" data-no-tooltip translate="no">adaptive_max_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Adaptive max pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#avg_pool/2" data-no-tooltip translate="no">avg_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Average pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#global_avg_pool/2" data-no-tooltip translate="no">global_avg_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Global average pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#global_lp_pool/2" data-no-tooltip translate="no">global_lp_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Global LP pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#global_max_pool/2" data-no-tooltip translate="no">global_max_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Global max pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#lp_pool/2" data-no-tooltip translate="no">lp_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Power average pool layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#max_pool/2" data-no-tooltip translate="no">max_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Max pool layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-normalization summary">
  <h2>
    <a href="#layers-normalization">Layers: Normalization</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#batch_norm/2" data-no-tooltip translate="no">batch_norm(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Batch normalization layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#group_norm/3" data-no-tooltip translate="no">group_norm(x, num_groups, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a group normalization layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#instance_norm/2" data-no-tooltip translate="no">instance_norm(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds an Instance normalization layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#layer_norm/2" data-no-tooltip translate="no">layer_norm(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a Layer normalization layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-recurrent summary">
  <h2>
    <a href="#layers-recurrent">Layers: Recurrent</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#conv_lstm/2" data-no-tooltip translate="no">conv_lstm(x, units)</a>

      </div>

        <div class="summary-synopsis"><p>See <a href="#conv_lstm/3"><code class="inline">conv_lstm/3</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#conv_lstm/3" data-no-tooltip translate="no">conv_lstm(x, units, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a convolutional long short-term memory (LSTM) layer to the network
with a random initial hidden state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#conv_lstm/4" data-no-tooltip translate="no">conv_lstm(x, hidden_state, units, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a convolutional long short-term memory (LSTM) layer to the network
with the given initial hidden state..</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#gru/2" data-no-tooltip translate="no">gru(x, units)</a>

      </div>

        <div class="summary-synopsis"><p>See <a href="#gru/3"><code class="inline">gru/3</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#gru/3" data-no-tooltip translate="no">gru(x, units, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a gated recurrent unit (GRU) layer to the network with
a random initial hidden state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#gru/4" data-no-tooltip translate="no">gru(x, hidden_state, units, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a gated recurrent unit (GRU) layer to the network with
the given initial hidden state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#lstm/2" data-no-tooltip translate="no">lstm(x, units)</a>

      </div>

        <div class="summary-synopsis"><p>See <a href="#lstm/3"><code class="inline">lstm/3</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#lstm/3" data-no-tooltip translate="no">lstm(x, units, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a long short-term memory (LSTM) layer to the network
with a random initial hidden state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#lstm/4" data-no-tooltip translate="no">lstm(x, hidden_state, units, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a long short-term memory (LSTM) layer to the network
with the given initial hidden state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#mask/3" data-no-tooltip translate="no">mask(input, eos_token, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Computes a sequence mask according to the given EOS token.</p></div>

    </div>

</div>
<div class="summary-layers-combinators summary">
  <h2>
    <a href="#layers-combinators">Layers: Combinators</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#add/3" data-no-tooltip translate="no">add(x, y, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a add layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#concatenate/3" data-no-tooltip translate="no">concatenate(x, y, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a concatenate layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#cond/5" data-no-tooltip translate="no">cond(parent, cond_fn, true_graph, false_graph, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a conditional layer which conditionally executes
<code class="inline">true_graph</code> or <code class="inline">false_graph</code> based on the condition <code class="inline">cond_fn</code>
at runtime.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#multiply/3" data-no-tooltip translate="no">multiply(x, y, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a multiply layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#split/3" data-no-tooltip translate="no">split(parent, splits, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Splits input graph into a container of <code class="inline">n</code> input graphs
along the given axis.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#subtract/3" data-no-tooltip translate="no">subtract(x, y, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a subtract layer to the network.</p></div>

    </div>

</div>
<div class="summary-layers-shape summary">
  <h2>
    <a href="#layers-shape">Layers: Shape</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#flatten/2" data-no-tooltip translate="no">flatten(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a flatten layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#pad/4" data-no-tooltip translate="no">pad(x, config, value \\ 0.0, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a pad layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#reshape/3" data-no-tooltip translate="no">reshape(x, new_shape, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a reshape layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#resize/3" data-no-tooltip translate="no">resize(x, resize_shape, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a resize layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#transpose/3" data-no-tooltip translate="no">transpose(x, permutation \\ nil, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a transpose layer to the network.</p></div>

    </div>

</div>
<div class="summary-model summary">
  <h2>
    <a href="#model">Model</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#build/2" data-no-tooltip translate="no">build(model, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Builds the given model to <code class="inline">{init_fn, predict_fn}</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#compile/4" data-no-tooltip translate="no">compile(model, template, init_params \\ Axon.ModelState.empty(), opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Compiles the given model to <code class="inline">{init_params, predict_fn}</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#freeze/2" data-no-tooltip translate="no">freeze(model, fun_or_predicate \\ :all)</a>

          <span class="deprecated" title="Use Axon.ModelState.freeze/2 instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Freezes parameters returned from the given function or predicate.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#predict/4" data-no-tooltip translate="no">predict(model, params, input, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Builds and runs the given Axon <code class="inline">model</code> with <code class="inline">params</code> and <code class="inline">input</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#unfreeze/2" data-no-tooltip translate="no">unfreeze(model, fun_or_predicate \\ :all)</a>

          <span class="deprecated" title="Use Axon.ModelState.freeze/2 instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Unfreezes parameters returned from the given function or predicate.</p></div>

    </div>

</div>
<div class="summary-model-manipulation summary">
  <h2>
    <a href="#model-manipulation">Model: Manipulation</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_inputs/1" data-no-tooltip translate="no">get_inputs(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Returns information about a model's inputs.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_op_counts/1" data-no-tooltip translate="no">get_op_counts(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a map of model op counts for each unique operation
in a model by their given <code class="inline">:op_name</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_options/1" data-no-tooltip translate="no">get_options(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a node's immediate input options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_output_shape/3" data-no-tooltip translate="no">get_output_shape(axon, inputs, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Returns a model's output template from the given input
template.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_parameters/1" data-no-tooltip translate="no">get_parameters(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a node's immediate parameters.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#map_nodes/2" data-no-tooltip translate="no">map_nodes(axon, fun)</a>

      </div>

        <div class="summary-synopsis"><p>Traverses graph nodes in order, applying <code class="inline">fun</code> to each
node exactly once to return a transformed node in its
place(s) in the graph.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#pop_node/1" data-no-tooltip translate="no">pop_node(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Pops the top node off of the graph.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#reduce_nodes/3" data-no-tooltip translate="no">reduce_nodes(axon, acc, fun)</a>

      </div>

        <div class="summary-synopsis"><p>Traverses graph nodes in order, applying <code class="inline">fun</code> to each
node exactly once to return a transformed node in its
place(s) in the graph.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#rewrite_nodes/2" data-no-tooltip translate="no">rewrite_nodes(axon, fun)</a>

      </div>

        <div class="summary-synopsis"><p>Rewrite and manipulate nodes in the Axon execution graph.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_options/2" data-no-tooltip translate="no">set_options(axon, new_opts)</a>

      </div>

        <div class="summary-synopsis"><p>Sets a node's immediate options to the given input
options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#set_parameters/2" data-no-tooltip translate="no">set_parameters(axon, new_params)</a>

      </div>

        <div class="summary-synopsis"><p>Sets a node's immediate parameters to the given
parameters.</p></div>

    </div>

</div>
<div class="summary-model-debugging summary">
  <h2>
    <a href="#model-debugging">Model: Debugging</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#attach_hook/3" data-no-tooltip translate="no">attach_hook(x, fun, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Attaches a hook to the given Axon model.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#trace_backward/5" data-no-tooltip translate="no">trace_backward(model, inputs, params, loss, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Compiles and returns the given model's backward function
expression with respect to the given loss function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#trace_forward/4" data-no-tooltip translate="no">trace_forward(model, inputs, params, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Compiles and returns the given model's forward function
expression with the given options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#trace_init/4" data-no-tooltip translate="no">trace_init(model, template, params \\ Axon.ModelState.empty(), opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Compiles and returns the given model's init function
expression with the given options.</p></div>

    </div>

</div>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:t/0" data-no-tooltip translate="no">t()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bidirectional/4" data-no-tooltip translate="no">bidirectional(input, forward_fun, merge_fun, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Applies the given forward function bidirectionally and merges
the results with the given merge function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#blur_pool/2" data-no-tooltip translate="no">blur_pool(x, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Adds a blur pooling layer to the network.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#properties/1" data-no-tooltip translate="no">properties(axon)</a>

      </div>

        <div class="summary-synopsis"><p>Returns a mapping of layer names to layer properties.</p></div>

    </div>

</div>

  </section>


  <section id="layers-special" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-special">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Special</span>
    </h1>
    <div class="layers-special-list">
<section class="detail" id="block/2">

    <span id="block/1"></span>

  <div class="detail-header">
    <a href="#block/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">block(fun, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L792" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a function which represents a self-contained re-usable block
of operations in a neural network. All parameters in the block are
shared between every usage of the block.</p><p>This returns an arity-1 function which accepts a list of inputs which
are forwarded to <code class="inline">fun</code>. This is most often used in situations where
you wish to re-use parameters in a block:</p><pre><code class="makeup elixir" translate="no"><span class="n">reused_dense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">block</span><span class="p" data-group-id="9838102072-1">(</span><span class="o">&amp;</span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="9838102072-2">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="9838102072-2">)</span><span class="p" data-group-id="9838102072-1">)</span></code></pre><p>Everytime <code class="inline">reused_dense</code> is invoked, it re-uses the same parameters:</p><pre><code class="makeup elixir" translate="no"><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="0680027236-1">(</span><span class="s">&quot;features&quot;</span><span class="p" data-group-id="0680027236-1">)</span><span class="w">
</span><span class="c1"># unique parameters</span><span class="w">
</span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="0680027236-2">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="0680027236-2">)</span><span class="w">
</span><span class="c1"># unique parameters</span><span class="w">
</span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reused_dense</span><span class="o">.</span><span class="p" data-group-id="0680027236-3">(</span><span class="n">x1</span><span class="p" data-group-id="0680027236-3">)</span><span class="w">
</span><span class="c1"># parameters shared</span><span class="w">
</span><span class="n">x3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reused_dense</span><span class="o">.</span><span class="p" data-group-id="0680027236-4">(</span><span class="n">x2</span><span class="p" data-group-id="0680027236-4">)</span></code></pre><p>Subgraphs in blocks can be arbitrarily complex:</p><pre><code class="makeup elixir" translate="no"><span class="n">reused_block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">block</span><span class="p" data-group-id="3682768601-1">(</span><span class="k" data-group-id="3682768601-2">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">x</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="3682768601-3">(</span><span class="mi">32</span><span class="p" data-group-id="3682768601-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="3682768601-4">(</span><span class="mi">64</span><span class="p" data-group-id="3682768601-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="3682768601-5">(</span><span class="mi">32</span><span class="p" data-group-id="3682768601-5">)</span><span class="w">
</span><span class="k" data-group-id="3682768601-2">end</span><span class="p" data-group-id="3682768601-1">)</span></code></pre><p>Blocks can also have multiple inputs, you can invoke a block with multiple
inputs by passing a list of arguments:</p><pre><code class="makeup elixir" translate="no"><span class="n">reused_block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">block</span><span class="p" data-group-id="2223546328-1">(</span><span class="k" data-group-id="2223546328-2">fn</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="2223546328-3">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="2223546328-3">)</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="2223546328-4">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="2223546328-4">)</span><span class="w">
  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="2223546328-5">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="2223546328-5">)</span><span class="w">

  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="2223546328-6">(</span><span class="p" data-group-id="2223546328-7">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p" data-group-id="2223546328-7">]</span><span class="p" data-group-id="2223546328-6">)</span><span class="w">
</span><span class="k" data-group-id="2223546328-2">end</span><span class="p" data-group-id="2223546328-1">)</span><span class="w">

</span><span class="c1"># invoke with a list</span><span class="w">
</span><span class="n">reused_block</span><span class="o">.</span><span class="p" data-group-id="2223546328-8">(</span><span class="p" data-group-id="2223546328-9">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p" data-group-id="2223546328-9">]</span><span class="p" data-group-id="2223546328-8">)</span></code></pre><p>Blocks prefix subgraph parameters with their name and a dot. As with other
Axon layers, if a name is not explicitly provided, one will be dynamically
generated.</p>
  </section>
</section>
<section class="detail" id="constant/2">

    <span id="constant/1"></span>

  <div class="detail-header">
    <a href="#constant/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">constant(tensor, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L631" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a constant layer to the network.</p><p>Constant layers encapsulate Nx tensors in an Axon layer for ease
of use with other Axon layers. They can be used interchangeably
with other Axon layers:</p><pre><code class="makeup elixir" translate="no"><span class="n">inp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8258292779-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8258292779-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="8258292779-2">}</span><span class="p" data-group-id="8258292779-1">)</span><span class="w">
</span><span class="n">my_constant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">constant</span><span class="p" data-group-id="8258292779-3">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">iota</span><span class="p" data-group-id="8258292779-4">(</span><span class="p" data-group-id="8258292779-5">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="8258292779-5">}</span><span class="p" data-group-id="8258292779-4">)</span><span class="p" data-group-id="8258292779-3">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="8258292779-6">(</span><span class="n">inp</span><span class="p">,</span><span class="w"> </span><span class="n">my_constant</span><span class="p" data-group-id="8258292779-6">)</span></code></pre><p>Constant layers will be cast according to the mixed precision policy.
If it's important for your constant to retain it's type during
the computation, you will need to set the mixed precision policy to
ignore constant layers.</p><h2 id="constant/2-options" class="section-heading">
  <a href="#constant/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="container/2">

    <span id="container/1"></span>

  <div class="detail-header">
    <a href="#container/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">container(container, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L698" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a container layer to the network.</p><p>In certain cases you may want your model to have multiple
outputs. In order to make this work, you must &quot;join&quot; the
outputs into an Axon layer using this function for use in
initialization and inference later on.</p><p>The given container can be any valid Axon Nx container.</p><h2 id="container/2-options" class="section-heading">
  <a href="#container/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul><h2 id="container/2-examples" class="section-heading">
  <a href="#container/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="n">inp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="3364275687-1">(</span><span class="s">&quot;input_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3364275687-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="3364275687-2">}</span><span class="p" data-group-id="3364275687-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">inp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="3364275687-3">(</span><span class="s">&quot;input_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3364275687-4">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="3364275687-4">}</span><span class="p" data-group-id="3364275687-3">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">container</span><span class="p" data-group-id="3364275687-5">(</span><span class="p" data-group-id="3364275687-6">%{</span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">inp1</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p">:</span><span class="w"> </span><span class="n">inp2</span><span class="p" data-group-id="3364275687-6">}</span><span class="p" data-group-id="3364275687-5">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="p" data-group-id="3364275687-7">%{</span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p">:</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="3364275687-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">predict</span><span class="p" data-group-id="3364275687-8">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="nc">Axon.ModelState</span><span class="o">.</span><span class="n">empty</span><span class="p" data-group-id="3364275687-9">(</span><span class="p" data-group-id="3364275687-9">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3364275687-10">%{</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">   </span><span class="s">&quot;input_0&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3364275687-11">(</span><span class="p" data-group-id="3364275687-12">[</span><span class="p" data-group-id="3364275687-13">[</span><span class="mf">1.0</span><span class="p" data-group-id="3364275687-13">]</span><span class="p" data-group-id="3364275687-12">]</span><span class="p" data-group-id="3364275687-11">)</span><span class="p">,</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">   </span><span class="s">&quot;input_1&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">tensor</span><span class="p" data-group-id="3364275687-14">(</span><span class="p" data-group-id="3364275687-15">[</span><span class="p" data-group-id="3364275687-16">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p" data-group-id="3364275687-16">]</span><span class="p" data-group-id="3364275687-15">]</span><span class="p" data-group-id="3364275687-14">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="p" data-group-id="3364275687-10">}</span><span class="p" data-group-id="3364275687-8">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">a</span><span class="w">
</span><span class="p" data-group-id="3364275687-17">#</span><span class="nc" data-group-id="3364275687-17">Nx.Tensor</span><span class="p" data-group-id="3364275687-17">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="3364275687-18">[</span><span class="mi">1</span><span class="p" data-group-id="3364275687-18">]</span><span class="p" data-group-id="3364275687-19">[</span><span class="mi">1</span><span class="p" data-group-id="3364275687-19">]</span><span class="w">
  </span><span class="p" data-group-id="3364275687-20">[</span><span class="w">
    </span><span class="p" data-group-id="3364275687-21">[</span><span class="mf">1.0</span><span class="p" data-group-id="3364275687-21">]</span><span class="w">
  </span><span class="p" data-group-id="3364275687-20">]</span><span class="w">
</span><span class="p" data-group-id="3364275687-17">&gt;</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">b</span><span class="w">
</span><span class="p" data-group-id="3364275687-22">#</span><span class="nc" data-group-id="3364275687-22">Nx.Tensor</span><span class="p" data-group-id="3364275687-22">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="3364275687-23">[</span><span class="mi">1</span><span class="p" data-group-id="3364275687-23">]</span><span class="p" data-group-id="3364275687-24">[</span><span class="mi">2</span><span class="p" data-group-id="3364275687-24">]</span><span class="w">
  </span><span class="p" data-group-id="3364275687-25">[</span><span class="w">
    </span><span class="p" data-group-id="3364275687-26">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p" data-group-id="3364275687-26">]</span><span class="w">
  </span><span class="p" data-group-id="3364275687-25">]</span><span class="w">
</span><span class="p" data-group-id="3364275687-22">&gt;</span></code></pre>
  </section>
</section>
<section class="detail" id="input/2">

    <span id="input/1"></span>

  <div class="detail-header">
    <a href="#input/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">input(name, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L515" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an input layer to the network.</p><p>Input layers specify a model's inputs. Input layers are
always the root layers of the neural network.</p><p>You must specify the input layers name, which will be used
to uniquely identify it in the case of multiple inputs.</p><h2 id="input/2-options" class="section-heading">
  <a href="#input/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:shape</code> - the expected input shape, use <code class="inline">nil</code> for dimensions
of a dynamic size.</p></li><li><p><code class="inline">:optional</code> - if <code class="inline">true</code>, the input may be omitted when using
the model. This needs to be handled in one of the subsequent
layers. See <a href="#optional/2"><code class="inline">optional/2</code></a> for more details.</p></li></ul>
  </section>
</section>
<section class="detail" id="layer/3">

    <span id="layer/2"></span>

  <div class="detail-header">
    <a href="#layer/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">layer(op, inputs, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L329" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Custom Axon layer with given inputs.</p><p>Inputs may be other Axon layers or trainable parameters created
with <code class="inline">Axon.param</code>. At inference time, <code class="inline">op</code> will be applied with
inputs in specified order and an additional <code class="inline">opts</code> parameter which
specifies inference options. All options passed to layer are forwarded
to inference function except:</p><ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:op_name</code> - layer operation for inspection and building parameter map.</p></li><li><p><code class="inline">:mode</code> - if the layer should run only on <code class="inline">:inference</code> or <code class="inline">:train</code>. Defaults to <code class="inline">:both</code></p></li><li><p><code class="inline">:global_options</code> - a list of global option names that this layer
supports. Global options passed to <a href="#build/2"><code class="inline">build/2</code></a> will be forwarded to
the layer, as long as they are declared</p></li></ul><p>Note this means your layer should not use these as input options,
as they will always be dropped during inference compilation.</p><p>Axon's compiler will additionally forward the following options to
every layer at inference time:</p><ul><li><code class="inline">:mode</code> - <code class="inline">:inference</code> or <code class="inline">:train</code>. To control layer behavior
based on inference or train time.</li></ul><p><code class="inline">op</code> is a function of the form:</p><pre><code class="makeup elixir" translate="no"><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="6922105776-1">fn</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">bias</span><span class="p">,</span><span class="w"> </span><span class="c">_opts</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">input</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bias</span><span class="w">
</span><span class="k" data-group-id="6922105776-1">end</span></code></pre>
  </section>
</section>
<section class="detail" id="nx/3">

    <span id="nx/2"></span>

  <div class="detail-header">
    <a href="#nx/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">nx(input, fun, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2088" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Applies the given <a href="https://hexdocs.pm/nx/0.9.0/Nx.html"><code class="inline">Nx</code></a> expression to the input.</p><p>Nx layers are meant for quick applications of functions without
trainable parameters. For example, they are useful for applying
functions which apply accessors to containers:</p><pre><code class="makeup elixir" translate="no"><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">container</span><span class="p" data-group-id="1151071808-1">(</span><span class="p" data-group-id="1151071808-2">{</span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="p" data-group-id="1151071808-2">}</span><span class="p" data-group-id="1151071808-1">)</span><span class="w">
</span><span class="nc">Axon</span><span class="o">.</span><span class="n">nx</span><span class="p" data-group-id="1151071808-3">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">elem</span><span class="p" data-group-id="1151071808-4">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1151071808-4">)</span><span class="p" data-group-id="1151071808-3">)</span></code></pre><h2 id="nx/3-options" class="section-heading">
  <a href="#nx/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="optional/2">

    <span id="optional/1"></span>

  <div class="detail-header">
    <a href="#optional/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">optional(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L584" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Wraps an Axon model in an optional node.</p><p>By default, when an optional input is missing, all subsequent layers
are nullified. For example, consider this model:</p><pre><code class="makeup elixir" translate="no"><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8151697303-1">(</span><span class="s">&quot;values&quot;</span><span class="p" data-group-id="8151697303-1">)</span><span class="w">
</span><span class="n">mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8151697303-2">(</span><span class="s">&quot;mask&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">optional</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="8151697303-2">)</span><span class="w">

</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">values</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="8151697303-3">(</span><span class="mi">10</span><span class="p" data-group-id="8151697303-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">multiply</span><span class="p" data-group-id="8151697303-4">(</span><span class="n">mask</span><span class="p" data-group-id="8151697303-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="8151697303-5">(</span><span class="mi">1</span><span class="p" data-group-id="8151697303-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">sigmoid</span><span class="p" data-group-id="8151697303-6">(</span><span class="p" data-group-id="8151697303-6">)</span></code></pre><p>In case the mask is not provided, the input node will resolve to
<code class="inline">%Axon.None{}</code> and so will all the layers that depend on it. By
using <a href="#optional/2"><code class="inline">optional/2</code></a> a layer may opt-in to receive <code class="inline">%Axon.None{}</code>.
To fix our example, we could define a custom layer to apply the
mask only when present</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">apply_optional_mask</span><span class="p" data-group-id="7433193884-1">(</span><span class="p" data-group-id="7433193884-2">%</span><span class="nc" data-group-id="7433193884-2">Axon</span><span class="p" data-group-id="7433193884-2">{</span><span class="p" data-group-id="7433193884-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7433193884-3">%</span><span class="nc" data-group-id="7433193884-3">Axon</span><span class="p" data-group-id="7433193884-3">{</span><span class="p" data-group-id="7433193884-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mask</span><span class="p" data-group-id="7433193884-1">)</span><span class="w"> </span><span class="k" data-group-id="7433193884-4">do</span><span class="w">
  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">layer</span><span class="p" data-group-id="7433193884-5">(</span><span class="w">
    </span><span class="k" data-group-id="7433193884-6">fn</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="c">_opts</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">case</span><span class="w"> </span><span class="n">mask</span><span class="w"> </span><span class="k" data-group-id="7433193884-7">do</span><span class="w">
        </span><span class="p" data-group-id="7433193884-8">%</span><span class="nc" data-group-id="7433193884-8">Axon.None</span><span class="p" data-group-id="7433193884-8">{</span><span class="p" data-group-id="7433193884-8">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w">
        </span><span class="n">mask</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">multiply</span><span class="p" data-group-id="7433193884-9">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p" data-group-id="7433193884-9">)</span><span class="w">
      </span><span class="k" data-group-id="7433193884-7">end</span><span class="w">
    </span><span class="k" data-group-id="7433193884-6">end</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7433193884-10">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">optional</span><span class="p" data-group-id="7433193884-11">(</span><span class="n">mask</span><span class="p" data-group-id="7433193884-11">)</span><span class="p" data-group-id="7433193884-10">]</span><span class="w">
  </span><span class="p" data-group-id="7433193884-5">)</span><span class="w">
</span><span class="k" data-group-id="7433193884-4">end</span><span class="w">

</span><span class="c1"># ...</span><span class="w">

</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">values</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="7433193884-12">(</span><span class="mi">10</span><span class="p" data-group-id="7433193884-12">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">apply_optional_mask</span><span class="p" data-group-id="7433193884-13">(</span><span class="n">mask</span><span class="p" data-group-id="7433193884-13">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="7433193884-14">(</span><span class="mi">1</span><span class="p" data-group-id="7433193884-14">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">sigmoid</span><span class="p" data-group-id="7433193884-15">(</span><span class="p" data-group-id="7433193884-15">)</span></code></pre><h2 id="optional/2-options" class="section-heading">
  <a href="#optional/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="or_else/3">

    <span id="or_else/2"></span>

  <div class="detail-header">
    <a href="#or_else/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">or_else(a, b, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L593" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Implements an or else (e.g. an Elixir ||)</p>
  </section>
</section>
<section class="detail" id="param/3">

    <span id="param/2"></span>

  <div class="detail-header">
    <a href="#param/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">param(name, shape, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L461" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Trainable Axon parameter used to create custom layers.</p><p>Parameters are specified in usages of <code class="inline">Axon.layer</code> and will
be automatically initialized and used in subsequent applications
of Axon models.</p><p>You may specify the parameter shape as either a static shape or
as function of the inputs to the given layer. If you specify the
parameter shape as a function, it will be given the</p><h2 id="param/3-options" class="section-heading">
  <a href="#param/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:initializer</code> - parameter initializer. Defaults to <code class="inline">:glorot_uniform</code>.</li></ul>
  </section>
</section>
<section class="detail" id="parameter/3">

    <span id="parameter/2"></span>

  <div class="detail-header">
    <a href="#parameter/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">parameter(name, template, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L411" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Trainable Axon parameter used to create custom layers.</p><p>Parameters are specified in usages of <code class="inline">Axon.layer</code> and will be
automatically initialized and used in subsequent applications of
Axon models.</p><p>You must specify a parameter &quot;template&quot; which can be a static template
tensor or a function which takes model input templates and returns a
template. It's most common to use functions because most parameters'
shapes rely on input shape information.</p>
  </section>
</section>
<section class="detail" id="stack_columns/2">

    <span id="stack_columns/1"></span>

  <div class="detail-header">
    <a href="#stack_columns/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">stack_columns(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3348" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a stack columns layer to the network.</p><p>A stack columns layer is designed to be used with <a href="https://hexdocs.pm/nx/0.9.0/Nx.LazyContainer.html"><code class="inline">Nx.LazyContainer</code></a>
data structures like Explorer DataFrames. Given an input which is a
DataFrame, <a href="#stack_columns/2"><code class="inline">stack_columns/2</code></a> will stack the columns in each row to
create a single vector.</p><p>You may optionally specify <code class="inline">:ignore</code> to ignore certain columns in
the container.</p><h2 id="stack_columns/2-options" class="section-heading">
  <a href="#stack_columns/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:ignore</code> - keys to ignore when stacking.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-activation" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-activation">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Activation</span>
    </h1>
    <div class="layers-activation-list">
<section class="detail" id="activation/3">

    <span id="activation/2"></span>

  <div class="detail-header">
    <a href="#activation/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">activation(x, activation, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1557" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an activation layer to the network.</p><p>Activation layers are element-wise functions typically called
after the output of another layer.</p><h2 id="activation/3-options" class="section-heading">
  <a href="#activation/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="celu/2">

    <span id="celu/1"></span>

  <div class="detail-header">
    <a href="#celu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">celu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Continuously-differentiable exponential linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#celu/1"><code class="inline">Axon.Activations.celu/1</code></a> for more details.</p><h2 id="celu/2-options" class="section-heading">
  <a href="#celu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="elu/2">

    <span id="elu/1"></span>

  <div class="detail-header">
    <a href="#elu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">elu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Exponential linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#elu/1"><code class="inline">Axon.Activations.elu/1</code></a> for more details.</p><h2 id="elu/2-options" class="section-heading">
  <a href="#elu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="exp/2">

    <span id="exp/1"></span>

  <div class="detail-header">
    <a href="#exp/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">exp(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Exponential activation layer to the network.</p><p>See <a href="Axon.Activations.html#exp/1"><code class="inline">Axon.Activations.exp/1</code></a> for more details.</p><h2 id="exp/2-options" class="section-heading">
  <a href="#exp/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="gelu/2">

    <span id="gelu/1"></span>

  <div class="detail-header">
    <a href="#gelu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">gelu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Gaussian error linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#gelu/1"><code class="inline">Axon.Activations.gelu/1</code></a> for more details.</p><h2 id="gelu/2-options" class="section-heading">
  <a href="#gelu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="hard_sigmoid/2">

    <span id="hard_sigmoid/1"></span>

  <div class="detail-header">
    <a href="#hard_sigmoid/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">hard_sigmoid(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Hard sigmoid activation layer to the network.</p><p>See <a href="Axon.Activations.html#hard_sigmoid/1"><code class="inline">Axon.Activations.hard_sigmoid/1</code></a> for more details.</p><h2 id="hard_sigmoid/2-options" class="section-heading">
  <a href="#hard_sigmoid/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="hard_silu/2">

    <span id="hard_silu/1"></span>

  <div class="detail-header">
    <a href="#hard_silu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">hard_silu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Hard sigmoid weighted linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#hard_silu/1"><code class="inline">Axon.Activations.hard_silu/1</code></a> for more details.</p><h2 id="hard_silu/2-options" class="section-heading">
  <a href="#hard_silu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="hard_tanh/2">

    <span id="hard_tanh/1"></span>

  <div class="detail-header">
    <a href="#hard_tanh/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">hard_tanh(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Hard hyperbolic tangent activation layer to the network.</p><p>See <a href="Axon.Activations.html#hard_tanh/1"><code class="inline">Axon.Activations.hard_tanh/1</code></a> for more details.</p><h2 id="hard_tanh/2-options" class="section-heading">
  <a href="#hard_tanh/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="leaky_relu/2">

    <span id="leaky_relu/1"></span>

  <div class="detail-header">
    <a href="#leaky_relu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">leaky_relu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Leaky rectified linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#leaky_relu/1"><code class="inline">Axon.Activations.leaky_relu/1</code></a> for more details.</p><h2 id="leaky_relu/2-options" class="section-heading">
  <a href="#leaky_relu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="linear/2">

    <span id="linear/1"></span>

  <div class="detail-header">
    <a href="#linear/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">linear(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Linear activation layer to the network.</p><p>See <a href="Axon.Activations.html#linear/1"><code class="inline">Axon.Activations.linear/1</code></a> for more details.</p><h2 id="linear/2-options" class="section-heading">
  <a href="#linear/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="log_sigmoid/2">

    <span id="log_sigmoid/1"></span>

  <div class="detail-header">
    <a href="#log_sigmoid/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">log_sigmoid(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Log-sigmoid activation layer to the network.</p><p>See <a href="Axon.Activations.html#log_sigmoid/1"><code class="inline">Axon.Activations.log_sigmoid/1</code></a> for more details.</p><h2 id="log_sigmoid/2-options" class="section-heading">
  <a href="#log_sigmoid/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="log_softmax/2">

    <span id="log_softmax/1"></span>

  <div class="detail-header">
    <a href="#log_softmax/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">log_softmax(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Log-softmax activation layer to the network.</p><p>See <a href="Axon.Activations.html#log_softmax/1"><code class="inline">Axon.Activations.log_softmax/1</code></a> for more details.</p><h2 id="log_softmax/2-options" class="section-heading">
  <a href="#log_softmax/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="log_sumexp/2">

    <span id="log_sumexp/1"></span>

  <div class="detail-header">
    <a href="#log_sumexp/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">log_sumexp(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Log-sumexp activation layer to the network.</p><p>See <a href="Axon.Activations.html#log_sumexp/1"><code class="inline">Axon.Activations.log_sumexp/1</code></a> for more details.</p><h2 id="log_sumexp/2-options" class="section-heading">
  <a href="#log_sumexp/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="mish/2">

    <span id="mish/1"></span>

  <div class="detail-header">
    <a href="#mish/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">mish(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Mish activation layer to the network.</p><p>See <a href="Axon.Activations.html#mish/1"><code class="inline">Axon.Activations.mish/1</code></a> for more details.</p><h2 id="mish/2-options" class="section-heading">
  <a href="#mish/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="relu6/2">

    <span id="relu6/1"></span>

  <div class="detail-header">
    <a href="#relu6/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">relu6(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Rectified linear unit 6 activation layer to the network.</p><p>See <a href="Axon.Activations.html#relu6/1"><code class="inline">Axon.Activations.relu6/1</code></a> for more details.</p><h2 id="relu6/2-options" class="section-heading">
  <a href="#relu6/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="relu/2">

    <span id="relu/1"></span>

  <div class="detail-header">
    <a href="#relu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">relu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Rectified linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#relu/1"><code class="inline">Axon.Activations.relu/1</code></a> for more details.</p><h2 id="relu/2-options" class="section-heading">
  <a href="#relu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="selu/2">

    <span id="selu/1"></span>

  <div class="detail-header">
    <a href="#selu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">selu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Scaled exponential linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#selu/1"><code class="inline">Axon.Activations.selu/1</code></a> for more details.</p><h2 id="selu/2-options" class="section-heading">
  <a href="#selu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="sigmoid/2">

    <span id="sigmoid/1"></span>

  <div class="detail-header">
    <a href="#sigmoid/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">sigmoid(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Sigmoid activation layer to the network.</p><p>See <a href="Axon.Activations.html#sigmoid/1"><code class="inline">Axon.Activations.sigmoid/1</code></a> for more details.</p><h2 id="sigmoid/2-options" class="section-heading">
  <a href="#sigmoid/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="silu/2">

    <span id="silu/1"></span>

  <div class="detail-header">
    <a href="#silu/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">silu(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Sigmoid weighted linear unit activation layer to the network.</p><p>See <a href="Axon.Activations.html#silu/1"><code class="inline">Axon.Activations.silu/1</code></a> for more details.</p><h2 id="silu/2-options" class="section-heading">
  <a href="#silu/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="softmax/2">

    <span id="softmax/1"></span>

  <div class="detail-header">
    <a href="#softmax/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">softmax(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Softmax activation layer to the network.</p><p>See <a href="Axon.Activations.html#softmax/1"><code class="inline">Axon.Activations.softmax/1</code></a> for more details.</p><h2 id="softmax/2-options" class="section-heading">
  <a href="#softmax/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="softplus/2">

    <span id="softplus/1"></span>

  <div class="detail-header">
    <a href="#softplus/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">softplus(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Softplus activation layer to the network.</p><p>See <a href="Axon.Activations.html#softplus/1"><code class="inline">Axon.Activations.softplus/1</code></a> for more details.</p><h2 id="softplus/2-options" class="section-heading">
  <a href="#softplus/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="softsign/2">

    <span id="softsign/1"></span>

  <div class="detail-header">
    <a href="#softsign/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">softsign(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Softsign activation layer to the network.</p><p>See <a href="Axon.Activations.html#softsign/1"><code class="inline">Axon.Activations.softsign/1</code></a> for more details.</p><h2 id="softsign/2-options" class="section-heading">
  <a href="#softsign/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="tanh/2">

    <span id="tanh/1"></span>

  <div class="detail-header">
    <a href="#tanh/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">tanh(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1583" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Hyperbolic tangent activation layer to the network.</p><p>See <a href="Axon.Activations.html#tanh/1"><code class="inline">Axon.Activations.tanh/1</code></a> for more details.</p><h2 id="tanh/2-options" class="section-heading">
  <a href="#tanh/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-linear" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-linear">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Linear</span>
    </h1>
    <div class="layers-linear-list">
<section class="detail" id="bias/2">

    <span id="bias/1"></span>

  <div class="detail-header">
    <a href="#bias/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">bias(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3321" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a bias layer to the network.</p><p>A bias layer simply adds a trainable bias to an input.</p><h2 id="bias/2-options" class="section-heading">
  <a href="#bias/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="bilinear/4">

    <span id="bilinear/3"></span>

  <div class="detail-header">
    <a href="#bilinear/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">bilinear(input1, input2, units, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L920" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a bilinear layer to the network.</p><p>The bilinear layer implements:</p><pre><code class="makeup elixir" translate="no"><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">activation</span><span class="p" data-group-id="4668280443-1">(</span><span class="n">dot</span><span class="p" data-group-id="4668280443-2">(</span><span class="n">dot</span><span class="p" data-group-id="4668280443-3">(</span><span class="n">input1</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p" data-group-id="4668280443-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">input2</span><span class="p" data-group-id="4668280443-2">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bias</span><span class="p" data-group-id="4668280443-1">)</span></code></pre><p>where <code class="inline">activation</code> is given by the <code class="inline">:activation</code> option and both
<code class="inline">kernel</code> and <code class="inline">bias</code> are layer parameters. <code class="inline">units</code> specifies the
number of output units.</p><p>All dimensions but the last of <code class="inline">input1</code> and <code class="inline">input2</code> must match. The
batch sizes of both inputs must also match or at least one must be <code class="inline">nil</code>.
Inferred output batch size coerces to the strictest input batch size.</p><p>Compiles to <a href="Axon.Layers.html#bilinear/5"><code class="inline">Axon.Layers.bilinear/5</code></a>.</p><h2 id="bilinear/4-options" class="section-heading">
  <a href="#bilinear/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="dense/3">

    <span id="dense/2"></span>

  <div class="detail-header">
    <a href="#dense/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">dense(x, units, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L846" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a dense layer to the network.</p><p>The dense layer implements:</p><pre><code class="makeup elixir" translate="no"><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">activation</span><span class="p" data-group-id="8742455192-1">(</span><span class="n">dot</span><span class="p" data-group-id="8742455192-2">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p" data-group-id="8742455192-2">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bias</span><span class="p" data-group-id="8742455192-1">)</span></code></pre><p>where <code class="inline">activation</code> is given by the <code class="inline">:activation</code> option and both
<code class="inline">kernel</code> and <code class="inline">bias</code> are layer parameters. <code class="inline">units</code> specifies the
number of output units.</p><p>Compiles to <a href="Axon.Layers.html#dense/4"><code class="inline">Axon.Layers.dense/4</code></a>.</p><h2 id="dense/3-options" class="section-heading">
  <a href="#dense/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="embedding/4">

    <span id="embedding/3"></span>

  <div class="detail-header">
    <a href="#embedding/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">embedding(x, vocab_size, embedding_size, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3297" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an embedding layer to the network.</p><p>An embedding layer initializes a kernel of shape <code class="inline">{vocab_size, embedding_size}</code>
which acts as a lookup table for sequences of discrete tokens (e.g. sentences).
Embeddings are typically used to obtain a dense representation of a sparse input
space.</p><h2 id="embedding/4-options" class="section-heading">
  <a href="#embedding/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights. Defaults
to <code class="inline">:uniform</code>.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-convolution" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-convolution">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Convolution</span>
    </h1>
    <div class="layers-convolution-list">
<section class="detail" id="conv/3">

    <span id="conv/2"></span>

  <div class="detail-header">
    <a href="#conv/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">conv(x, units, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1003" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a convolution layer to the network.</p><p>The convolution layer implements a general dimensional
convolutional layer - which convolves a kernel over the input
to produce an output.</p><p>Compiles to <a href="Axon.Layers.html#conv/4"><code class="inline">Axon.Layers.conv/4</code></a>.</p><h2 id="conv/3-options" class="section-heading">
  <a href="#conv/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code></p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:input_dilation</code> - dilation to apply to input. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:kernel_dilation</code> - dilation to apply to kernel. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:feature_group_size</code> - feature group size for convolution. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="conv_transpose/3">

    <span id="conv_transpose/2"></span>

  <div class="detail-header">
    <a href="#conv_transpose/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">conv_transpose(x, units, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1101" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a transposed convolution layer to the network.</p><p>The transposed convolution layer is sometimes referred to as a
fractionally strided convolution or (incorrectly) as a deconvolution.</p><p>Compiles to <a href="Axon.Layers.html#conv_transpose/4"><code class="inline">Axon.Layers.conv_transpose/4</code></a>.</p><h2 id="conv_transpose/3-options" class="section-heading">
  <a href="#conv_transpose/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code></p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:kernel_dilation</code> - dilation to apply to kernel. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="depthwise_conv/3">

    <span id="depthwise_conv/2"></span>

  <div class="detail-header">
    <a href="#depthwise_conv/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">depthwise_conv(x, channel_multiplier, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1200" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a depthwise convolution layer to the network.</p><p>The depthwise convolution layer implements a general
dimensional depthwise convolution - which is a convolution
where the feature group size is equal to the number of
input channels.</p><p>Channel multiplier grows the input channels by the given
factor. An input factor of 1 means the output channels
are the same as the input channels.</p><p>Compiles to <a href="Axon.Layers.html#depthwise_conv/4"><code class="inline">Axon.Layers.depthwise_conv/4</code></a>.</p><h2 id="depthwise_conv/3-options" class="section-heading">
  <a href="#depthwise_conv/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code></p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:input_dilation</code> - dilation to apply to input. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:kernel_dilation</code> - dilation to apply to kernel. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="separable_conv2d/3">

    <span id="separable_conv2d/2"></span>

  <div class="detail-header">
    <a href="#separable_conv2d/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">separable_conv2d(x, channel_multiplier, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1302" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a depthwise separable 2-dimensional convolution to the
network.</p><p>Depthwise separable convolutions break the kernel into kernels
for each dimension of the input and perform a depthwise conv
over the input with each kernel.</p><p>Compiles to <a href="Axon.Layers.html#separable_conv2d/6"><code class="inline">Axon.Layers.separable_conv2d/6</code></a>.</p><h2 id="separable_conv2d/3-options" class="section-heading">
  <a href="#separable_conv2d/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code></p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:input_dilation</code> - dilation to apply to input. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:kernel_dilation</code> - dilation to apply to kernel. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="separable_conv3d/3">

    <span id="separable_conv3d/2"></span>

  <div class="detail-header">
    <a href="#separable_conv3d/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">separable_conv3d(x, channel_multiplier, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1425" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a depthwise separable 3-dimensional convolution to the
network.</p><p>Depthwise separable convolutions break the kernel into kernels
for each dimension of the input and perform a depthwise conv
over the input with each kernel.</p><p>Compiles to <a href="Axon.Layers.html#separable_conv3d/8"><code class="inline">Axon.Layers.separable_conv3d/8</code></a>.</p><h2 id="separable_conv3d/3-options" class="section-heading">
  <a href="#separable_conv3d/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for <code class="inline">kernel</code> weights.
Defaults to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for <code class="inline">bias</code> weights. Defaults
to <code class="inline">:zeros</code></p></li><li><p><code class="inline">:activation</code> - element-wise activation function.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code></p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:input_dilation</code> - dilation to apply to input. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:kernel_dilation</code> - dilation to apply to kernel. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-dropout" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-dropout">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Dropout</span>
    </h1>
    <div class="layers-dropout-list">
<section class="detail" id="alpha_dropout/2">

    <span id="alpha_dropout/1"></span>

  <div class="detail-header">
    <a href="#alpha_dropout/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">alpha_dropout(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1612" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Alpha dropout layer to the network.</p><p>See <a href="Axon.Layers.html#alpha_dropout/2"><code class="inline">Axon.Layers.alpha_dropout/2</code></a> for more details.</p><h2 id="alpha_dropout/2-options" class="section-heading">
  <a href="#alpha_dropout/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:rate</code> - dropout rate. Defaults to <code class="inline">0.5</code>.
Needs to be equal or greater than zero and less than one.</p></li></ul>
  </section>
</section>
<section class="detail" id="dropout/2">

    <span id="dropout/1"></span>

  <div class="detail-header">
    <a href="#dropout/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">dropout(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1612" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Dropout layer to the network.</p><p>See <a href="Axon.Layers.html#dropout/2"><code class="inline">Axon.Layers.dropout/2</code></a> for more details.</p><h2 id="dropout/2-options" class="section-heading">
  <a href="#dropout/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:rate</code> - dropout rate. Defaults to <code class="inline">0.5</code>.
Needs to be equal or greater than zero and less than one.</p></li></ul>
  </section>
</section>
<section class="detail" id="feature_alpha_dropout/2">

    <span id="feature_alpha_dropout/1"></span>

  <div class="detail-header">
    <a href="#feature_alpha_dropout/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">feature_alpha_dropout(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1612" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Feature alpha dropout layer to the network.</p><p>See <a href="Axon.Layers.html#feature_alpha_dropout/2"><code class="inline">Axon.Layers.feature_alpha_dropout/2</code></a> for more details.</p><h2 id="feature_alpha_dropout/2-options" class="section-heading">
  <a href="#feature_alpha_dropout/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:rate</code> - dropout rate. Defaults to <code class="inline">0.5</code>.
Needs to be equal or greater than zero and less than one.</p></li></ul>
  </section>
</section>
<section class="detail" id="spatial_dropout/2">

    <span id="spatial_dropout/1"></span>

  <div class="detail-header">
    <a href="#spatial_dropout/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">spatial_dropout(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1612" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Spatial dropout layer to the network.</p><p>See <a href="Axon.Layers.html#spatial_dropout/2"><code class="inline">Axon.Layers.spatial_dropout/2</code></a> for more details.</p><h2 id="spatial_dropout/2-options" class="section-heading">
  <a href="#spatial_dropout/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:rate</code> - dropout rate. Defaults to <code class="inline">0.5</code>.
Needs to be equal or greater than zero and less than one.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-pooling" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-pooling">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Pooling</span>
    </h1>
    <div class="layers-pooling-list">
<section class="detail" id="adaptive_avg_pool/2">

    <span id="adaptive_avg_pool/1"></span>

  <div class="detail-header">
    <a href="#adaptive_avg_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">adaptive_avg_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1791" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Adaptive average pool layer to the network.</p><p>See <a href="Axon.Layers.html#adaptive_avg_pool/2"><code class="inline">Axon.Layers.adaptive_avg_pool/2</code></a> for more details.</p><h2 id="adaptive_avg_pool/2-options" class="section-heading">
  <a href="#adaptive_avg_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:output_size</code> - layer output size.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="adaptive_lp_pool/2">

    <span id="adaptive_lp_pool/1"></span>

  <div class="detail-header">
    <a href="#adaptive_lp_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">adaptive_lp_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1791" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Adaptive power average pool layer to the network.</p><p>See <a href="Axon.Layers.html#adaptive_lp_pool/2"><code class="inline">Axon.Layers.adaptive_lp_pool/2</code></a> for more details.</p><h2 id="adaptive_lp_pool/2-options" class="section-heading">
  <a href="#adaptive_lp_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:output_size</code> - layer output size.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="adaptive_max_pool/2">

    <span id="adaptive_max_pool/1"></span>

  <div class="detail-header">
    <a href="#adaptive_max_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">adaptive_max_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1791" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Adaptive max pool layer to the network.</p><p>See <a href="Axon.Layers.html#adaptive_max_pool/2"><code class="inline">Axon.Layers.adaptive_max_pool/2</code></a> for more details.</p><h2 id="adaptive_max_pool/2-options" class="section-heading">
  <a href="#adaptive_max_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:output_size</code> - layer output size.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="avg_pool/2">

    <span id="avg_pool/1"></span>

  <div class="detail-header">
    <a href="#avg_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">avg_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1675" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Average pool layer to the network.</p><p>See <a href="Axon.Layers.html#avg_pool/2"><code class="inline">Axon.Layers.avg_pool/2</code></a> for more details.</p><h2 id="avg_pool/2-options" class="section-heading">
  <a href="#avg_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to size of kernel.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:dilations</code> - window dilations. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="global_avg_pool/2">

    <span id="global_avg_pool/1"></span>

  <div class="detail-header">
    <a href="#global_avg_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">global_avg_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1858" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Global average pool layer to the network.</p><p>See <a href="Axon.Layers.html#global_avg_pool/2"><code class="inline">Axon.Layers.global_avg_pool/2</code></a> for more details.</p><p>Typically used to connect feature extractors such as those in convolutional
neural networks to fully-connected models by reducing inputs along spatial
dimensions to only feature and batch dimensions.</p><h2 id="global_avg_pool/2-options" class="section-heading">
  <a href="#global_avg_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:keep_axes</code> - option to keep reduced axes. If <code class="inline">true</code>, keeps reduced axes
with a dimension size of 1.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="global_lp_pool/2">

    <span id="global_lp_pool/1"></span>

  <div class="detail-header">
    <a href="#global_lp_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">global_lp_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1858" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Global LP pool layer to the network.</p><p>See <a href="Axon.Layers.html#global_lp_pool/2"><code class="inline">Axon.Layers.global_lp_pool/2</code></a> for more details.</p><p>Typically used to connect feature extractors such as those in convolutional
neural networks to fully-connected models by reducing inputs along spatial
dimensions to only feature and batch dimensions.</p><h2 id="global_lp_pool/2-options" class="section-heading">
  <a href="#global_lp_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:keep_axes</code> - option to keep reduced axes. If <code class="inline">true</code>, keeps reduced axes
with a dimension size of 1.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="global_max_pool/2">

    <span id="global_max_pool/1"></span>

  <div class="detail-header">
    <a href="#global_max_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">global_max_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1858" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Global max pool layer to the network.</p><p>See <a href="Axon.Layers.html#global_max_pool/2"><code class="inline">Axon.Layers.global_max_pool/2</code></a> for more details.</p><p>Typically used to connect feature extractors such as those in convolutional
neural networks to fully-connected models by reducing inputs along spatial
dimensions to only feature and batch dimensions.</p><h2 id="global_max_pool/2-options" class="section-heading">
  <a href="#global_max_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:keep_axes</code> - option to keep reduced axes. If <code class="inline">true</code>, keeps reduced axes
with a dimension size of 1.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="lp_pool/2">

    <span id="lp_pool/1"></span>

  <div class="detail-header">
    <a href="#lp_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">lp_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1675" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Power average pool layer to the network.</p><p>See <a href="Axon.Layers.html#lp_pool/2"><code class="inline">Axon.Layers.lp_pool/2</code></a> for more details.</p><h2 id="lp_pool/2-options" class="section-heading">
  <a href="#lp_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to size of kernel.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:dilations</code> - window dilations. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="max_pool/2">

    <span id="max_pool/1"></span>

  <div class="detail-header">
    <a href="#max_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">max_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1675" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Max pool layer to the network.</p><p>See <a href="Axon.Layers.html#max_pool/2"><code class="inline">Axon.Layers.max_pool/2</code></a> for more details.</p><h2 id="max_pool/2-options" class="section-heading">
  <a href="#max_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:kernel_size</code> - size of the kernel spatial dimensions. Defaults
to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to size of kernel.</p></li><li><p><code class="inline">:padding</code> - padding to the spatial dimensions of the input.
Defaults to <code class="inline">:valid</code>.</p></li><li><p><code class="inline">:dilations</code> - window dilations. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-normalization" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-normalization">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Normalization</span>
    </h1>
    <div class="layers-normalization-list">
<section class="detail" id="batch_norm/2">

    <span id="batch_norm/1"></span>

  <div class="detail-header">
    <a href="#batch_norm/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">batch_norm(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1919" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Batch normalization layer to the network.</p><p>See <a href="Axon.Layers.html#batch_norm/6"><code class="inline">Axon.Layers.batch_norm/6</code></a> for more details.</p><h2 id="batch_norm/2-options" class="section-heading">
  <a href="#batch_norm/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:gamma_initializer</code> - gamma parameter initializer. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:beta_initializer</code> - beta parameter initializer. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:channel_index</code> - input feature index used for calculating
mean and variance. Defaults to <code class="inline">-1</code>.</p></li><li><p><code class="inline">:epsilon</code> - numerical stability term. Defaults to <code class="inline">1.0e-5</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="group_norm/3">

    <span id="group_norm/2"></span>

  <div class="detail-header">
    <a href="#group_norm/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">group_norm(x, num_groups, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2043" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a group normalization layer to the network.</p><p>See <a href="Axon.Layers.html#group_norm/4"><code class="inline">Axon.Layers.group_norm/4</code></a> for more details.</p><h2 id="group_norm/3-options" class="section-heading">
  <a href="#group_norm/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:gamma_initializer</code> - gamma parameter initializer. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:beta_initializer</code> - beta parameter initializer. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:channel_index</code> - input feature index used for calculating
mean and variance. Defaults to <code class="inline">-1</code>.</p></li><li><p><code class="inline">:epsilon</code> - numerical stability term.</p></li></ul>
  </section>
</section>
<section class="detail" id="instance_norm/2">

    <span id="instance_norm/1"></span>

  <div class="detail-header">
    <a href="#instance_norm/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">instance_norm(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1919" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds an Instance normalization layer to the network.</p><p>See <a href="Axon.Layers.html#instance_norm/6"><code class="inline">Axon.Layers.instance_norm/6</code></a> for more details.</p><h2 id="instance_norm/2-options" class="section-heading">
  <a href="#instance_norm/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:gamma_initializer</code> - gamma parameter initializer. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:beta_initializer</code> - beta parameter initializer. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:channel_index</code> - input feature index used for calculating
mean and variance. Defaults to <code class="inline">-1</code>.</p></li><li><p><code class="inline">:epsilon</code> - numerical stability term. Defaults to <code class="inline">1.0e-5</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="layer_norm/2">

    <span id="layer_norm/1"></span>

  <div class="detail-header">
    <a href="#layer_norm/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">layer_norm(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1988" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a Layer normalization layer to the network.</p><p>See <a href="Axon.Layers.html#layer_norm/4"><code class="inline">Axon.Layers.layer_norm/4</code></a> for more details.</p><h2 id="layer_norm/2-options" class="section-heading">
  <a href="#layer_norm/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:gamma_initializer</code> - gamma parameter initializer. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:beta_initializer</code> - beta parameter initializer. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:channel_index</code> - input feature index used for calculating
mean and variance. Defaults to <code class="inline">-1</code>.</p></li><li><p><code class="inline">:epsilon</code> - numerical stability term.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-recurrent" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-recurrent">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Recurrent</span>
    </h1>
    <div class="layers-recurrent-list">
<section class="detail" id="conv_lstm/2">

  <div class="detail-header">
    <a href="#conv_lstm/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">conv_lstm(x, units)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3010" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>See <a href="#conv_lstm/3"><code class="inline">conv_lstm/3</code></a>.</p>
  </section>
</section>
<section class="detail" id="conv_lstm/3">

  <div class="detail-header">
    <a href="#conv_lstm/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">conv_lstm(x, units, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3027" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a convolutional long short-term memory (LSTM) layer to the network
with a random initial hidden state.</p><p>See <a href="#conv_lstm/4"><code class="inline">conv_lstm/4</code></a> for more details.</p><h2 id="conv_lstm/3-additional-options" class="section-heading">
  <a href="#conv_lstm/3-additional-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Additional options</span>
</h2>
<ul><li><code class="inline">:recurrent_initializer</code> - initializer for hidden state. Defaults
to <code class="inline">:orthogonal</code>.</li></ul>
  </section>
</section>
<section class="detail" id="conv_lstm/4">

  <div class="detail-header">
    <a href="#conv_lstm/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">conv_lstm(x, hidden_state, units, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3077" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a convolutional long short-term memory (LSTM) layer to the network
with the given initial hidden state..</p><p>ConvLSTMs apply <code class="inline">Axon.Layers.conv_lstm_cell/5</code> over an entire input
sequence and return:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="4196624741-1">{</span><span class="p" data-group-id="4196624741-2">{</span><span class="n">new_cell</span><span class="p">,</span><span class="w"> </span><span class="n">new_hidden</span><span class="p" data-group-id="4196624741-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">output_sequence</span><span class="p" data-group-id="4196624741-1">}</span></code></pre><p>You can use the output state as the hidden state of another
ConvLSTM layer.</p><h2 id="conv_lstm/4-options" class="section-heading">
  <a href="#conv_lstm/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:padding</code> - convolutional padding. Defaults to <code class="inline">:same</code>.</p></li><li><p><code class="inline">:kernel_size</code> - convolutional kernel size. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:strides</code> - convolutional strides. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:unroll</code> - <code class="inline">:dynamic</code> (loop preserving) or <code class="inline">:static</code> (compiled)
unrolling of RNN.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for kernel weights. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for bias weights. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="gru/2">

  <div class="detail-header">
    <a href="#gru/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">gru(x, units)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2767" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>See <a href="#gru/3"><code class="inline">gru/3</code></a>.</p>
  </section>
</section>
<section class="detail" id="gru/3">

  <div class="detail-header">
    <a href="#gru/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">gru(x, units, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2784" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a gated recurrent unit (GRU) layer to the network with
a random initial hidden state.</p><p>See <a href="#gru/4"><code class="inline">gru/4</code></a> for more details.</p><h2 id="gru/3-additional-options" class="section-heading">
  <a href="#gru/3-additional-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Additional options</span>
</h2>
<ul><li><code class="inline">:recurrent_initializer</code> - initializer for hidden state.
Defaults to <code class="inline">:orthogonal</code>.</li></ul>
  </section>
</section>
<section class="detail" id="gru/4">

  <div class="detail-header">
    <a href="#gru/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">gru(x, hidden_state, units, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2831" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a gated recurrent unit (GRU) layer to the network with
the given initial hidden state.</p><p>GRUs apply <a href="Axon.Layers.html#gru_cell/7"><code class="inline">Axon.Layers.gru_cell/7</code></a> over an entire input
sequence and return:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="3323373965-1">{</span><span class="p" data-group-id="3323373965-2">{</span><span class="n">new_hidden</span><span class="p" data-group-id="3323373965-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">output_sequence</span><span class="p" data-group-id="3323373965-1">}</span></code></pre><p>You can use the output state as the hidden state of another
GRU layer.</p><h2 id="gru/4-options" class="section-heading">
  <a href="#gru/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:activation</code> - recurrent activation. Defaults to <code class="inline">:tanh</code>.</p></li><li><p><code class="inline">:gate</code> - recurrent gate function. Defaults to <code class="inline">:sigmoid</code>.</p></li><li><p><code class="inline">:unroll</code> - <code class="inline">:dynamic</code> (loop preserving) or <code class="inline">:static</code> (compiled)
unrolling of RNN.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for kernel weights. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for bias weights. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="lstm/2">

  <div class="detail-header">
    <a href="#lstm/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">lstm(x, units)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2527" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>See <a href="#lstm/3"><code class="inline">lstm/3</code></a>.</p>
  </section>
</section>
<section class="detail" id="lstm/3">

  <div class="detail-header">
    <a href="#lstm/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">lstm(x, units, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2544" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a long short-term memory (LSTM) layer to the network
with a random initial hidden state.</p><p>See <a href="#lstm/4"><code class="inline">lstm/4</code></a> for more details.</p><h2 id="lstm/3-additional-options" class="section-heading">
  <a href="#lstm/3-additional-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Additional options</span>
</h2>
<ul><li><code class="inline">:recurrent_initializer</code> - initializer for hidden state.
Defaults to <code class="inline">:orthogonal</code>.</li></ul>
  </section>
</section>
<section class="detail" id="lstm/4">

  <div class="detail-header">
    <a href="#lstm/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">lstm(x, hidden_state, units, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2592" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a long short-term memory (LSTM) layer to the network
with the given initial hidden state.</p><p>LSTMs apply <a href="Axon.Layers.html#lstm_cell/7"><code class="inline">Axon.Layers.lstm_cell/7</code></a> over an entire input
sequence and return:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="9573556244-1">{</span><span class="n">output_sequence</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9573556244-2">{</span><span class="n">new_cell</span><span class="p">,</span><span class="w"> </span><span class="n">new_hidden</span><span class="p" data-group-id="9573556244-2">}</span><span class="p" data-group-id="9573556244-1">}</span></code></pre><p>You can use the output state as the hidden state of another
LSTM layer.</p><h2 id="lstm/4-options" class="section-heading">
  <a href="#lstm/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:activation</code> - recurrent activation. Defaults to <code class="inline">:tanh</code>.</p></li><li><p><code class="inline">:gate</code> - recurrent gate function. Defaults to <code class="inline">:sigmoid</code>.</p></li><li><p><code class="inline">:unroll</code> - <code class="inline">:dynamic</code> (loop preserving) or <code class="inline">:static</code> (compiled)
unrolling of RNN.</p></li><li><p><code class="inline">:kernel_initializer</code> - initializer for kernel weights. Defaults
to <code class="inline">:glorot_uniform</code>.</p></li><li><p><code class="inline">:bias_initializer</code> - initializer for bias weights. Defaults to
<code class="inline">:zeros</code>.</p></li><li><p><code class="inline">:use_bias</code> - whether the layer should add bias to the output.
Defaults to <code class="inline">true</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="mask/3">

    <span id="mask/2"></span>

  <div class="detail-header">
    <a href="#mask/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">mask(input, eos_token, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2468" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Computes a sequence mask according to the given EOS token.</p><p>Masks can be propagated to recurrent layers or custom layers to
indicate that a given token should be ignored in processing. This
is useful when you have sequences of variable length.</p><p>Most commonly, <code class="inline">eos_token</code> is <code class="inline">0</code>.</p><h2 id="mask/3-options" class="section-heading">
  <a href="#mask/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-combinators" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-combinators">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Combinators</span>
    </h1>
    <div class="layers-combinators-list">
<section class="detail" id="add/3">

  <div class="detail-header">
    <a href="#add/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">add(x, y, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2308" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a add layer to the network.</p><p>This layer performs an element-wise add operation
on input layers. All input layers must be capable of being
broadcast together.</p><p>If one shape has a static batch size, all other shapes must have a
static batch size as well.</p><h2 id="add/3-options" class="section-heading">
  <a href="#add/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="concatenate/3">

  <div class="detail-header">
    <a href="#concatenate/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">concatenate(x, y, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2256" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a concatenate layer to the network.</p><p>This layer will concatenate inputs along the last
dimension unless specified otherwise.</p><h2 id="concatenate/3-options" class="section-heading">
  <a href="#concatenate/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:axis</code> - concatenate axis. Defaults to <code class="inline">-1</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="cond/5">

    <span id="cond/4"></span>

  <div class="detail-header">
    <a href="#cond/5" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">cond(parent, cond_fn, true_graph, false_graph, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2361" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a conditional layer which conditionally executes
<code class="inline">true_graph</code> or <code class="inline">false_graph</code> based on the condition <code class="inline">cond_fn</code>
at runtime.</p><p><code class="inline">cond_fn</code> is an arity-1 function executed on the output of the
parent graph. It must return a boolean scalar tensor (e.g. 1 or 0).</p><p>The shapes of <code class="inline">true_graph</code> and <code class="inline">false_graph</code> must be equal.</p>
  </section>
</section>
<section class="detail" id="multiply/3">

  <div class="detail-header">
    <a href="#multiply/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">multiply(x, y, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2308" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a multiply layer to the network.</p><p>This layer performs an element-wise multiply operation
on input layers. All input layers must be capable of being
broadcast together.</p><p>If one shape has a static batch size, all other shapes must have a
static batch size as well.</p><h2 id="multiply/3-options" class="section-heading">
  <a href="#multiply/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="split/3">

    <span id="split/2"></span>

  <div class="detail-header">
    <a href="#split/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">split(parent, splits, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2391" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Splits input graph into a container of <code class="inline">n</code> input graphs
along the given axis.</p><h2 id="split/3-options" class="section-heading">
  <a href="#split/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:axis</code> - concatenate axis. Defaults to <code class="inline">-1</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="subtract/3">

  <div class="detail-header">
    <a href="#subtract/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">subtract(x, y, opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2308" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a subtract layer to the network.</p><p>This layer performs an element-wise subtract operation
on input layers. All input layers must be capable of being
broadcast together.</p><p>If one shape has a static batch size, all other shapes must have a
static batch size as well.</p><h2 id="subtract/3-options" class="section-heading">
  <a href="#subtract/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="layers-shape" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#layers-shape">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Layers: Shape</span>
    </h1>
    <div class="layers-shape-list">
<section class="detail" id="flatten/2">

    <span id="flatten/1"></span>

  <div class="detail-header">
    <a href="#flatten/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">flatten(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2111" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a flatten layer to the network.</p><p>This layer will flatten all but the batch dimensions
of the input into a single layer. Typically called to flatten
the output of a convolution for use with a dense layer.</p><h2 id="flatten/2-options" class="section-heading">
  <a href="#flatten/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="pad/4">

    <span id="pad/2"></span>

    <span id="pad/3"></span>

  <div class="detail-header">
    <a href="#pad/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">pad(x, config, value \\ 0.0, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2184" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a pad layer to the network.</p><p>This layer will pad the spatial dimensions of the input.
Padding configuration is a list of tuples for each spatial
dimension.</p><h2 id="pad/4-options" class="section-heading">
  <a href="#pad/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or
<code class="inline">:last</code>. Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="reshape/3">

    <span id="reshape/2"></span>

  <div class="detail-header">
    <a href="#reshape/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">reshape(x, new_shape, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2137" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a reshape layer to the network.</p><p>This layer implements a special case of <code class="inline">Nx.reshape</code> which accounts
for possible batch dimensions in the input tensor. You may pass the
magic dimension <code class="inline">:batch</code> as a placeholder for dynamic batch sizes.
You can use <code class="inline">:batch</code> seamlessly with <code class="inline">:auto</code> dimension sizes.</p><p>If the input is an Axon constant, the reshape behavior matches that of
<a href="https://hexdocs.pm/nx/0.9.0/Nx.html#reshape/2"><code class="inline">Nx.reshape/2</code></a>.</p><h2 id="reshape/3-options" class="section-heading">
  <a href="#reshape/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>
<section class="detail" id="resize/3">

    <span id="resize/2"></span>

  <div class="detail-header">
    <a href="#resize/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">resize(x, resize_shape, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2225" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a resize layer to the network.</p><p>Resizing can be used for interpolation or upsampling input
values in a neural network. For example, you can use this
layer as an upsampling layer within a GAN.</p><p>Resize shape must be a tuple representing the resized spatial
dimensions of the input tensor.</p><p>Compiles to <a href="Axon.Layers.html#resize/2"><code class="inline">Axon.Layers.resize/2</code></a>.</p><h2 id="resize/3-options" class="section-heading">
  <a href="#resize/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:method</code> - resize method. Defaults to <code class="inline">:nearest</code>.</p></li><li><p><code class="inline">:antialias</code> - whether an anti-aliasing filter should be used
when downsampling. Defaults to <code class="inline">true</code>.</p></li><li><p><code class="inline">:channels</code> - channel configuration. One of <code class="inline">:first</code> or
<code class="inline">:last</code>. Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="transpose/3">

    <span id="transpose/1"></span>

    <span id="transpose/2"></span>

  <div class="detail-header">
    <a href="#transpose/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">transpose(x, permutation \\ nil, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2157" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a transpose layer to the network.</p><h2 id="transpose/3-options" class="section-heading">
  <a href="#transpose/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:name</code> - layer name.</li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="model" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#model">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Model</span>
    </h1>
    <div class="model-list">
<section class="detail" id="build/2">

    <span id="build/1"></span>

  <div class="detail-header">
    <a href="#build/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">build(model, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3915" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Builds the given model to <code class="inline">{init_fn, predict_fn}</code>.</p><p>The given functions can be either given as arguments to <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.html"><code class="inline">Nx.Defn</code></a>
functions or be invoked directly, to perform just-in-time compilation
and execution. If you want to compile the model (instead of just-in-time)
based on a predefined initialization shape, see <a href="#compile/4"><code class="inline">compile/4</code></a>.</p><h2 id="build/2-init_fn" class="section-heading">
  <a href="#build/2-init_fn" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text"><code class="inline">init_fn</code></span>
</h2>
<p>The <code class="inline">init_fn</code> receives two arguments, the input template and
an optional map with initial parameters for layers:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="5314163977-1">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="5314163977-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="5314163977-2">(</span><span class="n">model</span><span class="p" data-group-id="5314163977-2">)</span><span class="w">
</span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="5314163977-3">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="5314163977-4">(</span><span class="p" data-group-id="5314163977-5">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="5314163977-5">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5314163977-6">{</span><span class="ss">:f</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p" data-group-id="5314163977-6">}</span><span class="p" data-group-id="5314163977-4">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5314163977-7">%{</span><span class="s">&quot;dense_0&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">dense_params</span><span class="p" data-group-id="5314163977-7">}</span><span class="p" data-group-id="5314163977-3">)</span></code></pre><h2 id="build/2-predict_fn" class="section-heading">
  <a href="#build/2-predict_fn" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text"><code class="inline">predict_fn</code></span>
</h2>
<p>The <code class="inline">predict_fn</code> receives two arguments, the trained parameters
and the actual inputs:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="0007252248-1">{</span><span class="c">_init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="0007252248-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="0007252248-2">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="0007252248-2">)</span><span class="w">
</span><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="0007252248-3">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p" data-group-id="0007252248-3">)</span></code></pre><h2 id="build/2-options" class="section-heading">
  <a href="#build/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:compiler</code> - the underlying <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.html"><code class="inline">Nx.Defn</code></a> compiler to perform
JIT compilation when the functions are invoked. If none is
passed, it uses the default compiler configured in <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.html"><code class="inline">Nx.Defn</code></a>;</p></li><li><p><code class="inline">:debug</code> - if <code class="inline">true</code>, will log graph traversal and generation
metrics. Also forwarded to JIT if debug mode is available
for your chosen compiler or backend. Defaults to <code class="inline">false</code></p></li><li><p><code class="inline">:print_values</code> - if <code class="inline">true</code>, will print intermediate layer
values to the screen for inspection. This is useful if you need
to debug intermediate values of a model</p></li><li><p><code class="inline">:mode</code> - one of <code class="inline">:inference</code> or <code class="inline">:train</code>. Forwarded to layers
to control differences in compilation at training or inference time.
Defaults to <code class="inline">:inference</code></p></li><li><p><code class="inline">:global_layer_options</code> - a keyword list of options passed to
layers that accept said options</p></li></ul><p>All other options are forwarded to the underlying JIT compiler.</p>
  </section>
</section>
<section class="detail" id="compile/4">

    <span id="compile/2"></span>

    <span id="compile/3"></span>

  <div class="detail-header">
    <a href="#compile/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">compile(model, template, init_params \\ Axon.ModelState.empty(), opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3949" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Compiles the given model to <code class="inline">{init_params, predict_fn}</code>.</p><p>This function will compile a model specialized to the given
input shapes and types. This is useful for avoiding the overhead
of long compilations at program runtime. You must provide template
inputs which match the expected shapes and types of inputs at
execution time. Depending on the Nx compiler, such as EXLA v0.9.1+,
both <code class="inline">init_params</code> the <code class="inline">predict_fn</code> can be sent across nodes, as
long the node that owns them keeps a reference to the underlying
resources.</p><p>This function makes use of the built-in <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.html#compile/3"><code class="inline">Nx.Defn.compile/3</code></a>. Note
that passing inputs which differ in shape or type from the templates
provided to this function will result in a crash.</p><h2 id="compile/4-options" class="section-heading">
  <a href="#compile/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<p>It accepts the same options as <a href="#build/2"><code class="inline">build/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="freeze/2">

    <span id="freeze/1"></span>

  <div class="detail-header">
    <a href="#freeze/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">freeze(model, fun_or_predicate \\ :all)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3398" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

    <div class="deprecated">
      This function is deprecated. Use Axon.ModelState.freeze/2 instead.
    </div>

  <section class="docstring">

<p>Freezes parameters returned from the given function or predicate.</p><p><code class="inline">fun</code> can be a predicate <code class="inline">:all</code>, <code class="inline">up: n</code>, or <code class="inline">down: n</code>. <code class="inline">:all</code>
freezes all parameters in the model, <code class="inline">up: n</code> freezes the first <code class="inline">n</code>
layers up (starting from output), and <code class="inline">down: n</code> freezes the first <code class="inline">n</code>
layers down (starting from input).</p><p><code class="inline">fun</code> may also be a predicate function which takes a parameter and
returns <code class="inline">true</code> if a parameter should be frozen or <code class="inline">false</code> otherwise.</p><p>Freezing parameters is useful when performing transfer learning
to leverage features learned from another problem in a new problem.
For example, it's common to combine the convolutional base from
larger models trained on ImageNet with fresh fully-connected classifiers.
The combined model is then trained on fresh data, with the convolutional
base frozen so as not to lose information. You can see this example
in code here:</p><pre><code class="makeup elixir" translate="no"><span class="n">cnn_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_pretrained_cnn_base</span><span class="p" data-group-id="0278514991-1">(</span><span class="p" data-group-id="0278514991-1">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">cnn_base</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">freeze</span><span class="p" data-group-id="0278514991-2">(</span><span class="p" data-group-id="0278514991-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">flatten</span><span class="p" data-group-id="0278514991-3">(</span><span class="p" data-group-id="0278514991-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="0278514991-4">(</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="ss">activation</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="0278514991-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dropout</span><span class="p" data-group-id="0278514991-5">(</span><span class="p" data-group-id="0278514991-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="0278514991-6">(</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="ss">activation</span><span class="p">:</span><span class="w"> </span><span class="ss">:softmax</span><span class="p" data-group-id="0278514991-6">)</span><span class="w">

</span><span class="n">model</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">trainer</span><span class="p" data-group-id="0278514991-7">(</span><span class="ss">:categorical_cross_entropy</span><span class="p">,</span><span class="w"> </span><span class="nc">Polaris.Optimizers</span><span class="o">.</span><span class="n">adam</span><span class="p" data-group-id="0278514991-8">(</span><span class="ss">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.005</span><span class="p" data-group-id="0278514991-8">)</span><span class="p" data-group-id="0278514991-7">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">run</span><span class="p" data-group-id="0278514991-9">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ss">epochs</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="0278514991-9">)</span></code></pre><p>When compiled, frozen parameters are wrapped in <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.Kernel.html#stop_grad/1"><code class="inline">Nx.Defn.Kernel.stop_grad/1</code></a>,
which zeros out the gradient with respect to the frozen parameter. Gradients
of frozen parameters will return <code class="inline">0.0</code>, meaning they won't be changed during
the update process.</p>
  </section>
</section>
<section class="detail" id="predict/4">

    <span id="predict/3"></span>

  <div class="detail-header">
    <a href="#predict/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">predict(model, params, input, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L4081" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Builds and runs the given Axon <code class="inline">model</code> with <code class="inline">params</code> and <code class="inline">input</code>.</p><p>This is equivalent to calling <a href="#build/2"><code class="inline">build/2</code></a> and then invoking the
predict function.</p><h2 id="predict/4-options" class="section-heading">
  <a href="#predict/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:mode</code> - one of <code class="inline">:inference</code> or <code class="inline">:train</code>. Forwarded to layers
to control differences in compilation at training or inference time.
Defaults to <code class="inline">:inference</code></p></li><li><p><code class="inline">:debug</code> - if <code class="inline">true</code>, will log graph traversal and generation
metrics. Also forwarded to JIT if debug mode is available
for your chosen compiler or backend. Defaults to <code class="inline">false</code></p></li></ul><p>All other options are forwarded to the default JIT compiler
or backend.</p>
  </section>
</section>
<section class="detail" id="unfreeze/2">

    <span id="unfreeze/1"></span>

  <div class="detail-header">
    <a href="#unfreeze/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">unfreeze(model, fun_or_predicate \\ :all)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3471" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

    <div class="deprecated">
      This function is deprecated. Use Axon.ModelState.freeze/2 instead.
    </div>

  <section class="docstring">

<p>Unfreezes parameters returned from the given function or predicate.</p><p><code class="inline">fun</code> can be a predicate <code class="inline">:all</code>, <code class="inline">up: n</code>, or <code class="inline">down: n</code>. <code class="inline">:all</code>
freezes all parameters in the model, <code class="inline">up: n</code> unfreezes the first <code class="inline">n</code>
layers up (starting from output), and <code class="inline">down: n</code> freezes the first <code class="inline">n</code>
layers down (starting from input).</p><p><code class="inline">fun</code> may also be a predicate function which takes a parameter and
returns <code class="inline">true</code> if a parameter should be unfrozen or <code class="inline">false</code> otherwise.</p><p>Unfreezing parameters is useful when fine tuning a model which you
have previously frozen and performed transfer learning on. You may
want to unfreeze some of the later frozen layers in a model and
fine tune them specifically for your application:</p><pre><code class="makeup elixir" translate="no"><span class="n">cnn_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_pretrained_cnn_base</span><span class="p" data-group-id="6396820198-1">(</span><span class="p" data-group-id="6396820198-1">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">frozen_model</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">unfreeze</span><span class="p" data-group-id="6396820198-2">(</span><span class="ss">up</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p" data-group-id="6396820198-2">)</span><span class="w">

</span><span class="n">model</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">trainer</span><span class="p" data-group-id="6396820198-3">(</span><span class="ss">:categorical_cross_entropy</span><span class="p">,</span><span class="w"> </span><span class="nc">Polaris.Optimizers</span><span class="o">.</span><span class="n">adam</span><span class="p" data-group-id="6396820198-4">(</span><span class="ss">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0005</span><span class="p" data-group-id="6396820198-4">)</span><span class="p" data-group-id="6396820198-3">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Loop</span><span class="o">.</span><span class="n">run</span><span class="p" data-group-id="6396820198-5">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ss">epochs</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6396820198-5">)</span></code></pre><p>When compiled, frozen parameters are wrapped in <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.Kernel.html#stop_grad/1"><code class="inline">Nx.Defn.Kernel.stop_grad/1</code></a>,
which zeros out the gradient with respect to the frozen parameter. Gradients
of frozen parameters will return <code class="inline">0.0</code>, meaning they won't be changed during
the update process.</p>
  </section>
</section>

    </div>
  </section>

  <section id="model-manipulation" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#model-manipulation">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Model: Manipulation</span>
    </h1>
    <div class="model-manipulation-list">
<section class="detail" id="get_inputs/1">

  <div class="detail-header">
    <a href="#get_inputs/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_inputs(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3619" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns information about a model's inputs.</p>
  </section>
</section>
<section class="detail" id="get_op_counts/1">

  <div class="detail-header">
    <a href="#get_op_counts/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_op_counts(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3674" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a map of model op counts for each unique operation
in a model by their given <code class="inline">:op_name</code>.</p><h2 id="get_op_counts/1-examples" class="section-heading">
  <a href="#get_op_counts/1-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4397334704-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4397334704-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4397334704-2">}</span><span class="p" data-group-id="4397334704-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="4397334704-3">(</span><span class="mi">2</span><span class="p" data-group-id="4397334704-3">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon</span><span class="o">.</span><span class="n">get_op_counts</span><span class="p" data-group-id="4397334704-4">(</span><span class="n">model</span><span class="p" data-group-id="4397334704-4">)</span><span class="w">
</span><span class="p" data-group-id="4397334704-5">%{</span><span class="ss">input</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">dense</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4397334704-5">}</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4397334704-6">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4397334704-7">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4397334704-7">}</span><span class="p" data-group-id="4397334704-6">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">tanh</span><span class="p" data-group-id="4397334704-8">(</span><span class="p" data-group-id="4397334704-8">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">tanh</span><span class="p" data-group-id="4397334704-9">(</span><span class="p" data-group-id="4397334704-9">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Axon</span><span class="o">.</span><span class="n">get_op_counts</span><span class="p" data-group-id="4397334704-10">(</span><span class="n">model</span><span class="p" data-group-id="4397334704-10">)</span><span class="w">
</span><span class="p" data-group-id="4397334704-11">%{</span><span class="ss">input</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">tanh</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="4397334704-11">}</span></code></pre>
  </section>
</section>
<section class="detail" id="get_options/1">

  <div class="detail-header">
    <a href="#get_options/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_options(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3589" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a node's immediate input options.</p><p>Note that this does not take into account options of
parent layers, only the option which belong to the
immediate layer.</p>
  </section>
</section>
<section class="detail" id="get_output_shape/3">

    <span id="get_output_shape/2"></span>

  <div class="detail-header">
    <a href="#get_output_shape/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_output_shape(axon, inputs, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3638" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a model's output template from the given input
template.</p><p>The output template gives you access to the output shape
and type of the given input graph.</p>
  </section>
</section>
<section class="detail" id="get_parameters/1">

  <div class="detail-header">
    <a href="#get_parameters/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_parameters(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3555" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a node's immediate parameters.</p><p>Note this does not take into account parameters of
parent layers - only the parameters which belong to
the immediate layer.</p>
  </section>
</section>
<section class="detail" id="map_nodes/2">

  <div class="detail-header">
    <a href="#map_nodes/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">map_nodes(axon, fun)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3725" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Traverses graph nodes in order, applying <code class="inline">fun</code> to each
node exactly once to return a transformed node in its
place(s) in the graph.</p><p>This function maintains an internal cache which ensures
each node is only visited and transformed exactly once.</p><p><code class="inline">fun</code> must accept an Axon node and return an Axon node.</p><p>Please note that modifying node lineage (e.g. altering
a node's parent) will result in disconnected graphs.</p><h2 id="map_nodes/2-examples" class="section-heading">
  <a href="#map_nodes/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>One common use of this function is to implement common
instrumentation between layers without needing to build
a new explicitly instrumented version of a model. For example,
you can use this function to visualize intermediate activations
of all convolutional layers in a model:</p><pre><code class="makeup elixir" translate="no"><span class="n">instrumented_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">map_nodes</span><span class="p" data-group-id="9655908094-1">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9655908094-2">fn</span><span class="w">
  </span><span class="p" data-group-id="9655908094-3">%</span><span class="nc" data-group-id="9655908094-3">Axon.Node</span><span class="p" data-group-id="9655908094-3">{</span><span class="ss">op</span><span class="p">:</span><span class="w"> </span><span class="ss">:conv</span><span class="p" data-group-id="9655908094-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">axon_node</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="9655908094-4">(</span><span class="n">axon_node</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">visualize_activations</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="9655908094-4">)</span><span class="w">

  </span><span class="n">axon_node</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">axon_node</span><span class="w">
</span><span class="k" data-group-id="9655908094-2">end</span><span class="p" data-group-id="9655908094-1">)</span></code></pre><p>Another use case is to replace entire classes of layers
with another. For example, you may want to replace all
relu layers with tanh layers:</p><pre><code class="makeup elixir" translate="no"><span class="n">new_model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">map_nodes</span><span class="p" data-group-id="7635909433-1">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7635909433-2">fn</span><span class="w">
  </span><span class="p" data-group-id="7635909433-3">%</span><span class="nc" data-group-id="7635909433-3">Axon.Node</span><span class="p" data-group-id="7635909433-3">{</span><span class="ss">op</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="7635909433-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">axon_node</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="7635909433-4">%{</span><span class="n">axon_node</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ss">op</span><span class="p">:</span><span class="w"> </span><span class="ss">:tanh</span><span class="p" data-group-id="7635909433-4">}</span><span class="w">

  </span><span class="n">graph</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">graph</span><span class="w">
</span><span class="k" data-group-id="7635909433-2">end</span><span class="p" data-group-id="7635909433-1">)</span></code></pre><p>For more complex graph rewriting and manipulation cases, see
<a href="#rewrite_nodes/2"><code class="inline">Axon.rewrite_nodes/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="pop_node/1">

  <div class="detail-header">
    <a href="#pop_node/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">pop_node(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3852" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Pops the top node off of the graph.</p><p>This returns the popped node and the updated graph:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="8583819393-1">{</span><span class="c">_node</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p" data-group-id="8583819393-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">pop_node</span><span class="p" data-group-id="8583819393-2">(</span><span class="n">model</span><span class="p" data-group-id="8583819393-2">)</span></code></pre>
  </section>
</section>
<section class="detail" id="reduce_nodes/3">

  <div class="detail-header">
    <a href="#reduce_nodes/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">reduce_nodes(axon, acc, fun)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3755" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Traverses graph nodes in order, applying <code class="inline">fun</code> to each
node exactly once to return a transformed node in its
place(s) in the graph.</p><p>This function maintains an internal cache which ensures
each node is only visited and transformed exactly once.</p><p><code class="inline">fun</code> must accept an Axon node and accumulator and return
an updated accumulator.</p><h2 id="reduce_nodes/3-examples" class="section-heading">
  <a href="#reduce_nodes/3-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>Internally this function is used in several places to accumulate
graph metadata. For example, you can use it to count the number
of a certain type of operation in the graph:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">reduce_nodes</span><span class="p" data-group-id="8818311423-1">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="8818311423-2">fn</span><span class="w">
  </span><span class="p" data-group-id="8818311423-3">%</span><span class="nc" data-group-id="8818311423-3">Axon.Node</span><span class="p" data-group-id="8818311423-3">{</span><span class="ss">op</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="8818311423-3">}</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">acc</span><span class="w">
</span><span class="k" data-group-id="8818311423-2">end</span><span class="p" data-group-id="8818311423-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="rewrite_nodes/2">

  <div class="detail-header">
    <a href="#rewrite_nodes/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">rewrite_nodes(axon, fun)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3789" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Rewrite and manipulate nodes in the Axon execution graph.</p><p>Axon models are represented as a graph of nodes. Working on these nodes
directly can be difficult and lead to disconnected and invalid graphs.
In some cases, you simply want to rewrite patterns. This function takes
an Axon model and traverses the nodes, applying the rewrite <code class="inline">fun</code> on each
node to rewrite some or all of the nodes in the Axon model.</p><p>The rewrite function is an arity-1 function which takes the current Axon node
as input and returns a function that replaces or rewrites the given node.
For example, you can define a simple rewriter which replaces the <code class="inline">:relu</code>
layers with <code class="inline">:tanh</code> layers:</p><pre><code class="makeup elixir" translate="no"><span class="n">tanh_rewriter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9999626946-1">fn</span><span class="w"> </span><span class="p" data-group-id="9999626946-2">[</span><span class="p" data-group-id="9999626946-3">%</span><span class="nc" data-group-id="9999626946-3">Axon</span><span class="p" data-group-id="9999626946-3">{</span><span class="p" data-group-id="9999626946-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p" data-group-id="9999626946-2">]</span><span class="p">,</span><span class="w"> </span><span class="c">_output</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">tanh</span><span class="p" data-group-id="9999626946-4">(</span><span class="n">x</span><span class="p" data-group-id="9999626946-4">)</span><span class="w">
</span><span class="k" data-group-id="9999626946-1">end</span><span class="w">

</span><span class="nc">Axon</span><span class="o">.</span><span class="n">rewrite_nodes</span><span class="p" data-group-id="9999626946-5">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9999626946-6">fn</span><span class="w">
  </span><span class="p" data-group-id="9999626946-7">%</span><span class="nc" data-group-id="9999626946-7">Axon.Node</span><span class="p" data-group-id="9999626946-7">{</span><span class="ss">op</span><span class="p">:</span><span class="w"> </span><span class="ss">:relu</span><span class="p" data-group-id="9999626946-7">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tanh_rewriter</span><span class="w">
  </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">:skip</span><span class="w">
</span><span class="k" data-group-id="9999626946-6">end</span><span class="p" data-group-id="9999626946-5">)</span></code></pre><p>Notice that the rewriter receives all of the original graph inputs <em>as well as</em>
the original graph outputs. This makes certain transformations which may rely
on both the input and output, such as LoRA, much easier to perform.</p>
  </section>
</section>
<section class="detail" id="set_options/2">

  <div class="detail-header">
    <a href="#set_options/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_options(axon, new_opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3606" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Sets a node's immediate options to the given input
options.</p><p>Note that this does not take into account options of
parent layers, only the option which belong to the
immediate layer.</p><p>New options must be compatible with the given layer
op. Adding unsupported options to an Axon layer will
result in an error at graph execution time.</p>
  </section>
</section>
<section class="detail" id="set_parameters/2">

  <div class="detail-header">
    <a href="#set_parameters/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">set_parameters(axon, new_params)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3571" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Sets a node's immediate parameters to the given
parameters.</p><p>Note this does not take into account parameters of
parent layers - only the parameters which belong to
the immediate layer.</p><p>The new parameters must be compatible with the layer's
old parameters.</p>
  </section>
</section>

    </div>
  </section>

  <section id="model-debugging" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#model-debugging">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Model: Debugging</span>
    </h1>
    <div class="model-debugging-list">
<section class="detail" id="attach_hook/3">

    <span id="attach_hook/2"></span>

  <div class="detail-header">
    <a href="#attach_hook/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">attach_hook(x, fun, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3523" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Attaches a hook to the given Axon model.</p><p>Hooks compile down to <a href="https://hexdocs.pm/nx/0.9.0/Nx.Defn.Kernel.html#hook/3"><code class="inline">Nx.Defn.Kernel.hook/3</code></a> and provide the same
functionality for adding side-effecting operations to a compiled
model. For example, you can use hooks to inspect intermediate activations,
send data to an external service, and more.</p><p>Hooks can be configured to be invoked on the following events:</p><ul><li><code class="inline">:initialize</code> - on model initialization.</li><li><code class="inline">:pre_forward</code> - before layer forward pass is invoked.</li><li><code class="inline">:forward</code> - after layer forward pass is invoked.</li><li><code class="inline">:backward</code> - after layer backward pass is invoked.</li></ul><p>To invoke a hook on every single event, you may pass <code class="inline">:all</code> to <code class="inline">on:</code>.</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="4042396432-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4042396432-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4042396432-2">}</span><span class="p" data-group-id="4042396432-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="4042396432-3">(</span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">on</span><span class="p">:</span><span class="w"> </span><span class="ss">:all</span><span class="p" data-group-id="4042396432-3">)</span></code></pre><p>The default event is <code class="inline">:forward</code>, assuming you want a hook invoked
on the layers forward pass.</p><p>You may configure hooks to run in one of only training or inference
mode using the <code class="inline">:mode</code> option. The default mode is <code class="inline">:both</code> to be invoked
during both train and inference mode.</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8857902479-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8857902479-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8857902479-2">}</span><span class="p" data-group-id="8857902479-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="8857902479-3">(</span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">on</span><span class="p">:</span><span class="w"> </span><span class="ss">:forward</span><span class="p">,</span><span class="w"> </span><span class="ss">mode</span><span class="p">:</span><span class="w"> </span><span class="ss">:train</span><span class="p" data-group-id="8857902479-3">)</span></code></pre><p>You can also attach multiple hooks to a single layer. Hooks are invoked in
the order in which they are declared. If order is important, you should attach
hooks in the order you want them to be executed:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="5169836871-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5169836871-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="5169836871-2">}</span><span class="p" data-group-id="5169836871-1">)</span><span class="w">
</span><span class="c1"># I will be executed first</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="5169836871-3">(</span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="5169836871-3">)</span><span class="w">
</span><span class="c1"># I will be executed second</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="5169836871-4">(</span><span class="k" data-group-id="5169836871-5">fn</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="o">.</span><span class="n">write</span><span class="p" data-group-id="5169836871-6">(</span><span class="s">&quot;HERE&quot;</span><span class="p" data-group-id="5169836871-6">)</span><span class="w"> </span><span class="k" data-group-id="5169836871-5">end</span><span class="p" data-group-id="5169836871-4">)</span></code></pre><p>Hooks are executed at their point of attachment. You must insert hooks at each point
you want a hook to execute during model execution.</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="8251217401-1">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">shape</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8251217401-2">{</span><span class="no">nil</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8251217401-2">}</span><span class="p" data-group-id="8251217401-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="8251217401-3">(</span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="8251217401-3">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">relu</span><span class="p" data-group-id="8251217401-4">(</span><span class="p" data-group-id="8251217401-4">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">attach_hook</span><span class="p" data-group-id="8251217401-5">(</span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="8251217401-5">)</span></code></pre>
  </section>
</section>
<section class="detail" id="trace_backward/5">

    <span id="trace_backward/4"></span>

  <div class="detail-header">
    <a href="#trace_backward/5" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">trace_backward(model, inputs, params, loss, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L4036" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Compiles and returns the given model's backward function
expression with respect to the given loss function.</p><p>The returned expression is an Nx expression which can be
traversed and lowered to an IR or inspected for debugging
purposes.</p><p>The given loss function must be a scalar loss function which
expects inputs and targets with the same shapes as the model's
output shapes as determined by the model's signature.</p><h2 id="trace_backward/5-options" class="section-heading">
  <a href="#trace_backward/5-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:debug</code> - if <code class="inline">true</code>, will log graph traversal and generation
metrics. Also forwarded to JIT if debug mode is available
for your chosen compiler or backend. Defaults to <code class="inline">false</code></li></ul>
  </section>
</section>
<section class="detail" id="trace_forward/4">

    <span id="trace_forward/3"></span>

  <div class="detail-header">
    <a href="#trace_forward/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">trace_forward(model, inputs, params, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L4011" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Compiles and returns the given model's forward function
expression with the given options.</p><p>The returned expression is an Nx expression which can be
traversed and lowered to an IR or inspected for debugging
purposes.</p><h2 id="trace_forward/4-options" class="section-heading">
  <a href="#trace_forward/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:mode</code> - one of <code class="inline">:inference</code> or <code class="inline">:train</code>. Forwarded to layers
to control differences in compilation at training or inference time.
Defaults to <code class="inline">:inference</code></p></li><li><p><code class="inline">:debug</code> - if <code class="inline">true</code>, will log graph traversal and generation
metrics. Also forwarded to JIT if debug mode is available
for your chosen compiler or backend. Defaults to <code class="inline">false</code></p></li></ul>
  </section>
</section>
<section class="detail" id="trace_init/4">

    <span id="trace_init/2"></span>

    <span id="trace_init/3"></span>

  <div class="detail-header">
    <a href="#trace_init/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">trace_init(model, template, params \\ Axon.ModelState.empty(), opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L3986" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Compiles and returns the given model's init function
expression with the given options.</p><p>The returned expression is an Nx expression which can be
traversed and lowered to an IR or inspected for debugging
purposes.</p><p>You may optionally specify initial parameters for some layers or
by passing a partial parameter map:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon</span><span class="o">.</span><span class="n">trace_init</span><span class="p" data-group-id="4853908210-1">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4853908210-2">%{</span><span class="s">&quot;dense_0&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">dense_params</span><span class="p" data-group-id="4853908210-2">}</span><span class="p" data-group-id="4853908210-1">)</span></code></pre><p>The parameter map will be merged with the initialized model
parameters.</p><h2 id="trace_init/4-options" class="section-heading">
  <a href="#trace_init/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:debug</code> - if <code class="inline">true</code>, will log graph traversal and generation
metrics. Also forwarded to JIT if debug mode is available
for your chosen compiler or backend. Defaults to <code class="inline">false</code></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:t/0">

  <div class="detail-header">
    <a href="#t:t/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">t()</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L286" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> t() :: %Axon{nodes: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), output: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="bidirectional/4">

    <span id="bidirectional/3"></span>

  <div class="detail-header">
    <a href="#bidirectional/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">bidirectional(input, forward_fun, merge_fun, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L2494" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Applies the given forward function bidirectionally and merges
the results with the given merge function.</p><p>This is most commonly used with RNNs to capture the dependencies
of a sequence in both directions.</p><h2 id="bidirectional/4-options" class="section-heading">
  <a href="#bidirectional/4-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">axis</code> - Axis to reverse.</li></ul>
  </section>
</section>
<section class="detail" id="blur_pool/2">

    <span id="blur_pool/1"></span>

  <div class="detail-header">
    <a href="#blur_pool/2" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">blur_pool(x, opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L1745" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Adds a blur pooling layer to the network.</p><p>See <a href="Axon.Layers.html#blur_pool/2"><code class="inline">Axon.Layers.blur_pool/2</code></a> for more details.</p><h2 id="blur_pool/2-options" class="section-heading">
  <a href="#blur_pool/2-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><p><code class="inline">:name</code> - layer name.</p></li><li><p><code class="inline">:strides</code> - stride during convolution. Defaults to <code class="inline">1</code>.</p></li><li><p><code class="inline">:channels</code> - channels location. One of <code class="inline">:first</code> or <code class="inline">:last</code>.
Defaults to <code class="inline">:last</code>.</p></li></ul>
  </section>
</section>
<section class="detail" id="properties/1">

  <div class="detail-header">
    <a href="#properties/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">properties(axon)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.7.0/lib/axon.ex#L4129" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns a mapping of layer names to layer properties.</p>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/axon/0.7.0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/axon/0.7.0">Hex Preview</a>

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="Axon.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>
<!-- Render math with KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

<!-- Render diagrams with Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({ startOnLoad: false });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition, function (svgSource, bindListeners) {
        graphEl.innerHTML = svgSource;
        bindListeners && bindListeners(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  });
</script>

  </body>
</html>
