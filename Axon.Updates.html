<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.28.0">
    <meta name="project" content="Axon v0.1.0-dev">

    <title>Axon.Updates â€” Axon v0.1.0-dev</title>
    <link rel="stylesheet" href="dist/elixir-a816d167216329cc463d.css" />

    <script src="dist/sidebar_items-0a3cb78c3e.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-80aa23c1d96b6dc3c064.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">


<section class="sidebar">
  <button class="sidebar-button sidebar-toggle">
    <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
  </button>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

    <div class="sidebar-projectDetails">
      <a href="Axon.html" class="sidebar-projectName" translate="no">
Axon
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.1.0-dev
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">Axon.Updates</span> 
  <small class="app-vsn" translate="no">(Axon v0.1.0-dev)</small>

</h1>


  <section id="moduledoc">
<p>Parameter update methods.</p><p>Update methods transform the input tensor in some way,
usually by scaling or shifting the input with respect
to some input state. Update methods are composed
to create more advanced optimization methods such as AdaGrad
or Adam. Each update returns a tuple:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="8782369744-1">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">update_fn</span><span class="p" data-group-id="8782369744-1">}</span></code></pre><p>Which represent a state initialization and state update
function respectively. While each method in the Updates
API is a regular Elixir function, the two methods they
return are implemented as <code class="inline">defn</code>, so they can be accelerated
using any Nx backend or compiler.</p><p>Update methods are just combinators that can be arbitrarily
composed to create complex optimizers. For example, the Adam
optimizer in Axon.Optimizers is implemented as:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">adam</span><span class="p" data-group-id="0011264641-1">(</span><span class="n">learning_rate</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="p" data-group-id="0011264641-2">[</span><span class="p" data-group-id="0011264641-2">]</span><span class="p" data-group-id="0011264641-1">)</span><span class="w"> </span><span class="k" data-group-id="0011264641-3">do</span><span class="w">
  </span><span class="nc">Updates</span><span class="o">.</span><span class="n">scale_by_adam</span><span class="p" data-group-id="0011264641-4">(</span><span class="n">opts</span><span class="p" data-group-id="0011264641-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Updates</span><span class="o">.</span><span class="n">scale</span><span class="p" data-group-id="0011264641-5">(</span><span class="o">-</span><span class="n">learning_rate</span><span class="p" data-group-id="0011264641-5">)</span><span class="w">
</span><span class="k" data-group-id="0011264641-3">end</span></code></pre><p>Updates are maps of updates, often associated with parameters of
the same names. Using <a href="#apply_updates/2"><code class="inline">Axon.Updates.apply_updates/2</code></a> will merge updates
and parameters by adding associated parameters and updates.</p><h2 id="module-custom-combinators" class="section-heading">
  <a href="#module-custom-combinators" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Custom combinators
</h2>
<p>You can create your own combinators using the <a href="#stateless/2"><code class="inline">stateless/2</code></a> and
<a href="#stateful/3"><code class="inline">stateful/3</code></a> primitives. Every update method in this module is
implemented in terms of one of these two primitives.</p><p><a href="#stateless/2"><code class="inline">stateless/2</code></a> represents a stateless update:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">scale</span><span class="p" data-group-id="6566928981-1">(</span><span class="n">combinator</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">identity</span><span class="p" data-group-id="6566928981-2">(</span><span class="p" data-group-id="6566928981-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">step_size</span><span class="p" data-group-id="6566928981-1">)</span><span class="w"> </span><span class="k" data-group-id="6566928981-3">do</span><span class="w">
  </span><span class="n">stateless</span><span class="p" data-group-id="6566928981-4">(</span><span class="n">combinator</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">apply_scale</span><span class="p" data-group-id="6566928981-5">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="ni">&amp;2</span><span class="p">,</span><span class="w"> </span><span class="n">step_size</span><span class="p" data-group-id="6566928981-5">)</span><span class="p" data-group-id="6566928981-4">)</span><span class="w">
</span><span class="k" data-group-id="6566928981-3">end</span><span class="w">

</span><span class="kd">defnp</span><span class="w"> </span><span class="nf">apply_scale</span><span class="p" data-group-id="6566928981-6">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="c">_params</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="p" data-group-id="6566928981-6">)</span><span class="w"> </span><span class="k" data-group-id="6566928981-7">do</span><span class="w">
  </span><span class="n">transform</span><span class="p" data-group-id="6566928981-8">(</span><span class="w">
    </span><span class="p" data-group-id="6566928981-9">{</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="p" data-group-id="6566928981-9">}</span><span class="p">,</span><span class="w">
    </span><span class="k" data-group-id="6566928981-10">fn</span><span class="w"> </span><span class="p" data-group-id="6566928981-11">{</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="p" data-group-id="6566928981-11">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">deep_new</span><span class="p" data-group-id="6566928981-12">(</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="6566928981-13">fn</span><span class="w"> </span><span class="p" data-group-id="6566928981-14">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p" data-group-id="6566928981-14">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">multiply</span><span class="p" data-group-id="6566928981-15">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="p" data-group-id="6566928981-15">)</span><span class="w"> </span><span class="k" data-group-id="6566928981-13">end</span><span class="p" data-group-id="6566928981-12">)</span><span class="w">
    </span><span class="k" data-group-id="6566928981-10">end</span><span class="w">
  </span><span class="p" data-group-id="6566928981-8">)</span><span class="w">
</span><span class="k" data-group-id="6566928981-7">end</span></code></pre><p>Notice how the function given to <a href="#stateless/2"><code class="inline">stateless/2</code></a> is defined within <code class="inline">defn</code>.
This is what allows the anonymous functions returned by <a href="Axon.Updates.html#content"><code class="inline">Axon.Updates</code></a>
to be used inside <code class="inline">defn</code>.</p><p><a href="#stateful/3"><code class="inline">stateful/3</code></a> represents a stateful update and follows the same pattern:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">my_stateful_update</span><span class="p" data-group-id="9720210228-1">(</span><span class="n">updates</span><span class="p" data-group-id="9720210228-1">)</span><span class="w"> </span><span class="k" data-group-id="9720210228-2">do</span><span class="w">
  </span><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">stateful</span><span class="p" data-group-id="9720210228-3">(</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">init_my_update</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">apply_my_update</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="9720210228-3">)</span><span class="w">
</span><span class="k" data-group-id="9720210228-2">end</span><span class="w">

</span><span class="kd">defnp</span><span class="w"> </span><span class="nf">init_my_update</span><span class="p" data-group-id="9720210228-4">(</span><span class="n">params</span><span class="p" data-group-id="9720210228-4">)</span><span class="w"> </span><span class="k" data-group-id="9720210228-5">do</span><span class="w">
  </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros_like</span><span class="p" data-group-id="9720210228-6">(</span><span class="n">params</span><span class="p" data-group-id="9720210228-6">)</span><span class="w">
  </span><span class="p" data-group-id="9720210228-7">%{</span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="n">state</span><span class="p" data-group-id="9720210228-7">}</span><span class="w">
</span><span class="k" data-group-id="9720210228-5">end</span><span class="w">

</span><span class="kd">defnp</span><span class="w"> </span><span class="nf">apply_my_update</span><span class="p" data-group-id="9720210228-8">(</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p" data-group-id="9720210228-8">)</span><span class="w"> </span><span class="k" data-group-id="9720210228-9">do</span><span class="w">
  </span><span class="n">new_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deep_new</span><span class="p" data-group-id="9720210228-10">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9720210228-11">fn</span><span class="w"> </span><span class="p" data-group-id="9720210228-12">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p" data-group-id="9720210228-12">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="9720210228-13">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">add</span><span class="p" data-group-id="9720210228-14">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p" data-group-id="9720210228-14">)</span><span class="p" data-group-id="9720210228-13">}</span><span class="w"> </span><span class="k" data-group-id="9720210228-11">end</span><span class="p" data-group-id="9720210228-10">)</span><span class="w">
  </span><span class="n">updates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transform</span><span class="p" data-group-id="9720210228-15">(</span><span class="p" data-group-id="9720210228-16">{</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="n">new_state</span><span class="p" data-group-id="9720210228-16">}</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9720210228-17">fn</span><span class="w"> </span><span class="p" data-group-id="9720210228-18">{</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p" data-group-id="9720210228-18">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">deep_merge</span><span class="p" data-group-id="9720210228-19">(</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9720210228-20">fn</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">multiply</span><span class="p" data-group-id="9720210228-21">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p" data-group-id="9720210228-21">)</span><span class="w"> </span><span class="k" data-group-id="9720210228-20">end</span><span class="p" data-group-id="9720210228-19">)</span><span class="w">
  </span><span class="k" data-group-id="9720210228-17">end</span><span class="p" data-group-id="9720210228-15">)</span><span class="w">
  </span><span class="p" data-group-id="9720210228-22">{</span><span class="n">updates</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9720210228-23">%{</span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="n">new_state</span><span class="p" data-group-id="9720210228-23">}</span><span class="p" data-group-id="9720210228-22">}</span><span class="w">
</span><span class="k" data-group-id="9720210228-9">end</span></code></pre><p>State associated with individual parameters should have keys that match the
keys of the parameter. For example, if you have parameters <code class="inline">%{kernel: kernel}</code>
with associated states <code class="inline">mu</code> and <code class="inline">nu</code> representing the first and second moments,
your state should look something like:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="8539503302-1">%{</span><span class="w">
  </span><span class="ss">mu</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8539503302-2">%{</span><span class="ss">kernel</span><span class="p">:</span><span class="w"> </span><span class="n">kernel_mu</span><span class="p" data-group-id="8539503302-2">}</span><span class="w">
  </span><span class="ss">nu</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8539503302-3">%{</span><span class="ss">kernel</span><span class="p">:</span><span class="w"> </span><span class="n">kernel_nu</span><span class="p" data-group-id="8539503302-3">}</span><span class="w">
</span><span class="p" data-group-id="8539503302-1">}</span></code></pre>
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
      Summary
    </h1>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#add_decayed_weights/2" translate="no">add_decayed_weights(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Weight decay.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#add_noise/2" translate="no">add_noise(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Add noise.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#apply_updates/3" translate="no">apply_updates(params, updates, state \\ nil)</a>

        </div>

          <div class="summary-synopsis"><p>Applies updates to params and updates state parameters with
given state map.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#centralize/1" translate="no">centralize(combinator \\ identity())</a>

        </div>

          <div class="summary-synopsis"><p>Centralize input.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#clip/2" translate="no">clip(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Clips input between -delta and delta.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#clip_by_global_norm/2" translate="no">clip_by_global_norm(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Clips input using input global norm.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#compose/2" translate="no">compose(arg1, arg2)</a>

        </div>

          <div class="summary-synopsis"><p>Composes two updates. This is useful for extending optimizers
without having to reimplement them. For example, you can implement
gradient centralization</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#identity/0" translate="no">identity()</a>

        </div>

          <div class="summary-synopsis"><p>Returns the identity update.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#identity/1" translate="no">identity(combinator)</a>

        </div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale/2" translate="no">scale(combinator \\ identity(), step_size)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input by a fixed step size.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_adam/2" translate="no">scale_by_adam(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input according to Adam algorithm.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_belief/2" translate="no">scale_by_belief(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input according to the AdaBelief algorithm.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_radam/2" translate="no">scale_by_radam(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scale input according to the Rectified Adam algorithm.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_rms/2" translate="no">scale_by_rms(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input by the root of the EMA of squared inputs.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_rss/2" translate="no">scale_by_rss(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input by the root of all prior squared inputs.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_schedule/2" translate="no">scale_by_schedule(combinator \\ identity(), schedule_fn)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input using the given schedule function.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_stddev/2" translate="no">scale_by_stddev(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scales input by the root of the centered EMA of squared inputs.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_trust_ratio/2" translate="no">scale_by_trust_ratio(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scale by trust ratio.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#scale_by_yogi/2" translate="no">scale_by_yogi(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Scale by yogi.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#stateful/3" translate="no">stateful(arg \\ identity(), init_fn, apply_fn)</a>

        </div>

          <div class="summary-synopsis"><p>Represents a stateful update.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#stateless/2" translate="no">stateless(arg \\ identity(), apply_fn)</a>

        </div>

          <div class="summary-synopsis"><p>Represents a stateless update.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#trace/2" translate="no">trace(combinator \\ identity(), opts)</a>

        </div>

          <div class="summary-synopsis"><p>Trace inputs with past inputs.</p></div>

      </div>

  </div>

  </section>


  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Functions
    </h1>
    <div class="functions-list">
<section class="detail" id="add_decayed_weights/2">

    <span id="add_decayed_weights/1"></span>

  <div class="detail-header">
    <a href="#add_decayed_weights/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">add_decayed_weights(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L586" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Weight decay.</p>
  </section>
</section>
<section class="detail" id="add_noise/2">

    <span id="add_noise/1"></span>

  <div class="detail-header">
    <a href="#add_noise/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">add_noise(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L633" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Add noise.</p>
  </section>
</section>
<section class="detail" id="apply_updates/3">

    <span id="apply_updates/2"></span>

  <div class="detail-header">
    <a href="#apply_updates/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">apply_updates(params, updates, state \\ nil)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L0" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Applies updates to params and updates state parameters with
given state map.</p>
  </section>
</section>
<section class="detail" id="centralize/1">

    <span id="centralize/0"></span>

  <div class="detail-header">
    <a href="#centralize/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">centralize(combinator \\ identity())</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L566" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Centralize input.</p>
  </section>
</section>
<section class="detail" id="clip/2">

    <span id="clip/1"></span>

  <div class="detail-header">
    <a href="#clip/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">clip(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L524" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Clips input between -delta and delta.</p><h2 id="clip/2-options" class="section-heading">
  <a href="#clip/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<ul><li><code class="inline">:delta</code> - maximum absolute value of the input. Defaults
to <code class="inline">2.0</code></li></ul>
  </section>
</section>
<section class="detail" id="clip_by_global_norm/2">

    <span id="clip_by_global_norm/1"></span>

  <div class="detail-header">
    <a href="#clip_by_global_norm/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">clip_by_global_norm(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L545" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Clips input using input global norm.</p><h2 id="clip_by_global_norm/2-options" class="section-heading">
  <a href="#clip_by_global_norm/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<ul><li><code class="inline">:max_norm</code> - maximum norm value of input. Defaults to
<code class="inline">1.0</code></li></ul>
  </section>
</section>
<section class="detail" id="compose/2">

  <div class="detail-header">
    <a href="#compose/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">compose(arg1, arg2)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L745" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Composes two updates. This is useful for extending optimizers
without having to reimplement them. For example, you can implement
gradient centralization:</p><pre><code class="makeup elixir" translate="no"><span class="kn">import</span><span class="w"> </span><span class="nc">Axon.Updates</span><span class="w">

</span><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">compose</span><span class="p" data-group-id="8211722402-1">(</span><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">centralize</span><span class="p" data-group-id="8211722402-2">(</span><span class="p" data-group-id="8211722402-2">)</span><span class="p">,</span><span class="w"> </span><span class="nc">Axon.Optimizers</span><span class="o">.</span><span class="n">rmsprop</span><span class="p" data-group-id="8211722402-3">(</span><span class="p" data-group-id="8211722402-3">)</span><span class="p" data-group-id="8211722402-1">)</span></code></pre><p>This is equivalent to:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">centralize</span><span class="p" data-group-id="2269480999-1">(</span><span class="p" data-group-id="2269480999-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon.Updates</span><span class="o">.</span><span class="n">scale_by_rms</span><span class="p" data-group-id="2269480999-2">(</span><span class="p" data-group-id="2269480999-2">)</span></code></pre>
  </section>
</section>
<section class="detail" id="identity/0">

  <div class="detail-header">
    <a href="#identity/0" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">identity()</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L723" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Returns the identity update.</p><p>This is often as the initial update in many functions in this module.</p>
  </section>
</section>
<section class="detail" id="identity/1">

  <div class="detail-header">
    <a href="#identity/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">identity(combinator)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L727" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">


  </section>
</section>
<section class="detail" id="scale/2">

    <span id="scale/1"></span>

  <div class="detail-header">
    <a href="#scale/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale(combinator \\ identity(), step_size)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L94" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input by a fixed step size.</p><p>$$f(x_i) = \alpha x_i$$</p>
  </section>
</section>
<section class="detail" id="scale_by_adam/2">

    <span id="scale_by_adam/1"></span>

  <div class="detail-header">
    <a href="#scale_by_adam/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_adam(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L122" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input according to Adam algorithm.</p><h2 id="scale_by_adam/2-options" class="section-heading">
  <a href="#scale_by_adam/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b1</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.9</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b2</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.999</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-8</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps_root</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-10</span><span class="err">`</span></code></pre><h2 id="scale_by_adam/2-references" class="section-heading">
  <a href="#scale_by_adam/2-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  References
</h2>
<ul><li><a href="https://arxiv.org/abs/1412.6980">Adam: A Method for Stochastic Optimization</a></li></ul>
  </section>
</section>
<section class="detail" id="scale_by_belief/2">

    <span id="scale_by_belief/1"></span>

  <div class="detail-header">
    <a href="#scale_by_belief/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_belief(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L268" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input according to the AdaBelief algorithm.</p><h2 id="scale_by_belief/2-options" class="section-heading">
  <a href="#scale_by_belief/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b1</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.9</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b2</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.999</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.0</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps_root</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-16</span><span class="err">`</span></code></pre><h2 id="scale_by_belief/2-references" class="section-heading">
  <a href="#scale_by_belief/2-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  References
</h2>
<ul><li><a href="https://arxiv.org/abs/2010.07468">AdaBelief Optimizer: Adapting Stepsizes by the Belief in Observed Gradients</a></li></ul>
  </section>
</section>
<section class="detail" id="scale_by_radam/2">

    <span id="scale_by_radam/1"></span>

  <div class="detail-header">
    <a href="#scale_by_radam/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_radam(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L391" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scale input according to the Rectified Adam algorithm.</p><h2 id="scale_by_radam/2-options" class="section-heading">
  <a href="#scale_by_radam/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b1</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.9</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:b2</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="n">decay</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.999</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-8</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps_root</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.0</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:threshold</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">variance</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">5.0</span><span class="err">`</span></code></pre><h2 id="scale_by_radam/2-references" class="section-heading">
  <a href="#scale_by_radam/2-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  References
</h2>
<ul><li><a href="https://arxiv.org/abs/1908.03265">On the Variance of the Adaptive Learning Rate and Beyond</a></li></ul>
  </section>
</section>
<section class="detail" id="scale_by_rms/2">

    <span id="scale_by_rms/1"></span>

  <div class="detail-header">
    <a href="#scale_by_rms/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_rms(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L223" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input by the root of the EMA of squared inputs.</p><h2 id="scale_by_rms/2-options" class="section-heading">
  <a href="#scale_by_rms/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:decay</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">EMA</span><span class="w"> </span><span class="n">decay</span><span class="w"> </span><span class="n">rate</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.9</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-8</span><span class="err">`</span></code></pre><h2 id="scale_by_rms/2-references" class="section-heading">
  <a href="#scale_by_rms/2-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  References
</h2>
<ul><li><a href="www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">Overview of mini-batch gradient descent</a></li></ul>
  </section>
</section>
<section class="detail" id="scale_by_rss/2">

    <span id="scale_by_rss/1"></span>

  <div class="detail-header">
    <a href="#scale_by_rss/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_rss(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L166" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input by the root of all prior squared inputs.</p><h2 id="scale_by_rss/2-options" class="section-heading">
  <a href="#scale_by_rss/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-7</span><span class="err">`</span></code></pre>
  </section>
</section>
<section class="detail" id="scale_by_schedule/2">

    <span id="scale_by_schedule/1"></span>

  <div class="detail-header">
    <a href="#scale_by_schedule/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_schedule(combinator \\ identity(), schedule_fn)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L352" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input using the given schedule function.</p>
  </section>
</section>
<section class="detail" id="scale_by_stddev/2">

    <span id="scale_by_stddev/1"></span>

  <div class="detail-header">
    <a href="#scale_by_stddev/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_stddev(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L317" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scales input by the root of the centered EMA of squared inputs.</p><h2 id="scale_by_stddev/2-options" class="section-heading">
  <a href="#scale_by_stddev/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<pre><code class="makeup elixir" translate="no"><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:decay</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nc">EMA</span><span class="w"> </span><span class="n">decay</span><span class="w"> </span><span class="n">rate</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">0.9</span><span class="err">`</span><span class="w">
</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="ss">:eps</span><span class="err">`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numerical</span><span class="w"> </span><span class="n">stability</span><span class="w"> </span><span class="n">term</span><span class="o">.</span><span class="w"> </span><span class="nc">Defaults</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="mf">1.0e-8</span><span class="err">`</span></code></pre><h2 id="scale_by_stddev/2-references" class="section-heading">
  <a href="#scale_by_stddev/2-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  References
</h2>
<ul><li><a href="www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">Overview of mini-batch gradient descent</a></li></ul>
  </section>
</section>
<section class="detail" id="scale_by_trust_ratio/2">

    <span id="scale_by_trust_ratio/1"></span>

  <div class="detail-header">
    <a href="#scale_by_trust_ratio/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_trust_ratio(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L602" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scale by trust ratio.</p>
  </section>
</section>
<section class="detail" id="scale_by_yogi/2">

    <span id="scale_by_yogi/1"></span>

  <div class="detail-header">
    <a href="#scale_by_yogi/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">scale_by_yogi(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L661" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Scale by yogi.</p>
  </section>
</section>
<section class="detail" id="stateful/3">

    <span id="stateful/2"></span>

  <div class="detail-header">
    <a href="#stateful/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">stateful(arg \\ identity(), init_fn, apply_fn)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L765" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Represents a stateful update.</p>
  </section>
</section>
<section class="detail" id="stateless/2">

    <span id="stateless/1"></span>

  <div class="detail-header">
    <a href="#stateless/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">stateless(arg \\ identity(), apply_fn)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L709" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Represents a stateless update.</p>
  </section>
</section>
<section class="detail" id="trace/2">

    <span id="trace/1"></span>

  <div class="detail-header">
    <a href="#trace/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">trace(combinator \\ identity(), opts)</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.1.0-dev/lib/axon/updates.ex#L482" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Trace inputs with past inputs.</p><h2 id="trace/2-options" class="section-heading">
  <a href="#trace/2-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a>
  Options
</h2>
<ul><li><code class="inline">:decay</code> - decay rate for tracing past updates. Defaults
to <code class="inline">0.9</code></li><li><code class="inline">:nesterov</code> - whether to use Nesterov momentum. Defaults
to <code class="inline">false</code></li></ul>
  </section>
</section>

    </div>
  </section>

      <footer class="footer">

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.28.0) for the
          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

  </body>
</html>
