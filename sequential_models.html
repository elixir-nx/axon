<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.1">
    <meta name="project" content="Axon v0.3.0">

    <title>Sequential models — Axon v0.3.0</title>
    <link rel="stylesheet" href="dist/html-elixir-V2ETBPMB.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-IV5W3OL2.js"></script>
    <script src="dist/sidebar_items-D6F7A6F8.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="extras" class="page-livemd">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="Axon.html">
        <img src="assets/logo.png" alt="Axon" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="Axon.html" class="sidebar-projectName" translate="no">
Axon
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.3.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="icon-action display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/guides/model_creation/sequential_models.livemd#L1" title="View Source" class="icon-action" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>


  <span>Sequential models</span>
</h1>

  <div class="livebook-badge-container">
    <a href="#" class="livebook-badge">
      <img src="https://livebook.dev/badge/v1/blue.svg" alt="Run in Livebook" width="150" />
    </a>
  </div>

<pre><code class="makeup elixir" translate="no"><span class="nc">Mix</span><span class="o">.</span><span class="n">install</span><span class="p" data-group-id="1525057987-1">(</span><span class="p" data-group-id="1525057987-2">[</span><span class="w">
  </span><span class="p" data-group-id="1525057987-3">{</span><span class="ss">:axon</span><span class="p">,</span><span class="w"> </span><span class="ss">github</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;elixir-nx/axon&quot;</span><span class="p" data-group-id="1525057987-3">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="1525057987-4">{</span><span class="ss">:nx</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.3.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">github</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;elixir-nx/nx&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">sparse</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nx&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">override</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1525057987-4">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="1525057987-5">{</span><span class="ss">:kino</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.7.0&quot;</span><span class="p" data-group-id="1525057987-5">}</span><span class="w">
</span><span class="p" data-group-id="1525057987-2">]</span><span class="p" data-group-id="1525057987-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="ss">:ok</span></code></pre><h2 id="creating-a-sequential-model" class="section-heading">
  <a href="#creating-a-sequential-model" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">creating-a-sequential-model</p>
  </a>
  Creating a sequential model
</h2>
<p>In the <a href="your_first_axon_model.html">last guide</a>, you created a simple identity model which just returned the input. Of course, you would never actually use Axon for such purposes. You want to create real neural networks!</p><p>In equivalent frameworks in the Python ecosystem such as Keras and PyTorch, there is a concept of <em>sequential models</em>. Sequential models are named after the sequential nature in which data flows through them. Sequential models transform the input with sequential, successive transformations.</p><p>If you're an experienced Elixir programmer, this paradigm of sequential transformations might sound a lot like what happens when using the pipe (<code class="inline">|&gt;</code>) operator. In Elixir, it's common to see code blocks like:</p><pre><code class="makeup elixir" translate="no"><span class="n">list</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="3888988200-1">(</span><span class="k" data-group-id="3888988200-2">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k" data-group-id="3888988200-2">end</span><span class="p" data-group-id="3888988200-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">filter</span><span class="p" data-group-id="3888988200-3">(</span><span class="o">&amp;</span><span class="n">rem</span><span class="p" data-group-id="3888988200-4">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="3888988200-4">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="3888988200-3">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">count</span><span class="p" data-group-id="3888988200-5">(</span><span class="p" data-group-id="3888988200-5">)</span></code></pre><p>The snippet above passes <code class="inline">list</code> through a sequence of transformations. You can apply this same paradigm in Axon to create sequential models. In fact, creating sequential models is so natural with Elixir's pipe operator, that Axon does not need a distinct <em>sequential</em> construct. To create a sequential model, you just pass Axon models through successive transformations in the Axon API:</p><pre><code class="makeup elixir" translate="no"><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="1896371660-1">(</span><span class="s">&quot;data&quot;</span><span class="p" data-group-id="1896371660-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="1896371660-2">(</span><span class="mi">32</span><span class="p" data-group-id="1896371660-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">activation</span><span class="p" data-group-id="1896371660-3">(</span><span class="ss">:relu</span><span class="p" data-group-id="1896371660-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dropout</span><span class="p" data-group-id="1896371660-4">(</span><span class="ss">rate</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="p" data-group-id="1896371660-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">dense</span><span class="p" data-group-id="1896371660-5">(</span><span class="mi">1</span><span class="p" data-group-id="1896371660-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">activation</span><span class="p" data-group-id="1896371660-6">(</span><span class="ss">:softmax</span><span class="p" data-group-id="1896371660-6">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="5529957030-1">#</span><span class="nc" data-group-id="5529957030-1">Axon</span><span class="p" data-group-id="5529957030-1">&lt;</span><span class="w">
  </span><span class="ss">inputs</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5529957030-2">%{</span><span class="s">&quot;data&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="no">nil</span><span class="p" data-group-id="5529957030-2">}</span><span class="w">
  </span><span class="ss">outputs</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;softmax_0&quot;</span><span class="w">
  </span><span class="ss">nodes</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
</span><span class="p" data-group-id="5529957030-1">&gt;</span></code></pre><p>If you visualize this model, it's easy to see how data flows sequentially through it:</p><pre><code class="makeup elixir" translate="no"><span class="n">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="5083880161-1">(</span><span class="p" data-group-id="5083880161-2">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p" data-group-id="5083880161-2">}</span><span class="p">,</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="5083880161-1">)</span><span class="w">
</span><span class="nc">Axon.Display</span><span class="o">.</span><span class="n">as_graph</span><span class="p" data-group-id="5083880161-3">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">template</span><span class="p" data-group-id="5083880161-3">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="n">graph</span><span class="w"> </span><span class="nc">TD</span><span class="p">;</span><span class="w">
</span><span class="mi">3</span><span class="p" data-group-id="7965309876-1">[</span><span class="o">/</span><span class="s">&quot;data (:input) {2, 16}&quot;</span><span class="o">/</span><span class="p" data-group-id="7965309876-1">]</span><span class="p">;</span><span class="w">
</span><span class="mi">6</span><span class="p" data-group-id="7965309876-2">[</span><span class="s">&quot;dense_0 (:dense) {2, 32}&quot;</span><span class="p" data-group-id="7965309876-2">]</span><span class="p">;</span><span class="w">
</span><span class="mi">7</span><span class="p" data-group-id="7965309876-3">[</span><span class="s">&quot;relu_0 (:relu) {2, 32}&quot;</span><span class="p" data-group-id="7965309876-3">]</span><span class="p">;</span><span class="w">
</span><span class="mi">8</span><span class="p" data-group-id="7965309876-4">[</span><span class="s">&quot;dropout_0 (:dropout) {2, 32}&quot;</span><span class="p" data-group-id="7965309876-4">]</span><span class="p">;</span><span class="w">
</span><span class="mi">11</span><span class="p" data-group-id="7965309876-5">[</span><span class="s">&quot;dense_1 (:dense) {2, 1}&quot;</span><span class="p" data-group-id="7965309876-5">]</span><span class="p">;</span><span class="w">
</span><span class="mi">12</span><span class="p" data-group-id="7965309876-6">[</span><span class="s">&quot;softmax_0 (:softmax) {2, 1}&quot;</span><span class="p" data-group-id="7965309876-6">]</span><span class="p">;</span><span class="w">
</span><span class="mi">11</span><span class="w"> </span><span class="o">--</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span><span class="p">;</span><span class="w">
</span><span class="mi">8</span><span class="w"> </span><span class="o">--</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w">
</span><span class="mi">7</span><span class="w"> </span><span class="o">--</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
</span><span class="mi">6</span><span class="w"> </span><span class="o">--</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">
</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span></code></pre><p>Your model is more involved and as a result so is the execution graph! Now, using the same constructs from the last section, you can build and run your model:</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="4201779844-1">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="4201779844-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="4201779844-2">(</span><span class="n">model</span><span class="p" data-group-id="4201779844-2">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="3727107613-1">{</span><span class="p" data-group-id="3727107613-2">#</span><span class="nc" data-group-id="3727107613-2">Function</span><span class="p" data-group-id="3727107613-2">&lt;</span><span class="mf">137.55749718</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Nx.Defn</span><span class="o">.</span><span class="n">wrap_arity</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="3727107613-2">&gt;</span><span class="p">,</span><span class="w">
 </span><span class="p" data-group-id="3727107613-3">#</span><span class="nc" data-group-id="3727107613-3">Function</span><span class="p" data-group-id="3727107613-3">&lt;</span><span class="mf">137.55749718</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Nx.Defn</span><span class="o">.</span><span class="n">wrap_arity</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="3727107613-3">&gt;</span><span class="p" data-group-id="3727107613-1">}</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="3054651193-1">(</span><span class="n">template</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3054651193-2">%{</span><span class="p" data-group-id="3054651193-2">}</span><span class="p" data-group-id="3054651193-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="4993553849-1">%{</span><span class="w">
  </span><span class="s">&quot;dense_0&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-2">%{</span><span class="w">
    </span><span class="s">&quot;bias&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-3">#</span><span class="nc" data-group-id="4993553849-3">Nx.Tensor</span><span class="p" data-group-id="4993553849-3">&lt;</span><span class="w">
      </span><span class="n">f32</span><span class="p" data-group-id="4993553849-4">[</span><span class="mi">32</span><span class="p" data-group-id="4993553849-4">]</span><span class="w">
      </span><span class="p" data-group-id="4993553849-5">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p" data-group-id="4993553849-5">]</span><span class="w">
    </span><span class="p" data-group-id="4993553849-3">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="s">&quot;kernel&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-6">#</span><span class="nc" data-group-id="4993553849-6">Nx.Tensor</span><span class="p" data-group-id="4993553849-6">&lt;</span><span class="w">
      </span><span class="n">f32</span><span class="p" data-group-id="4993553849-7">[</span><span class="mi">16</span><span class="p" data-group-id="4993553849-7">]</span><span class="p" data-group-id="4993553849-8">[</span><span class="mi">32</span><span class="p" data-group-id="4993553849-8">]</span><span class="w">
      </span><span class="p" data-group-id="4993553849-9">[</span><span class="w">
        </span><span class="p" data-group-id="4993553849-10">[</span><span class="o">-</span><span class="mf">0.25727564096450806</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.31299564242362976</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1557893306016922</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3321501314640045</span><span class="p">,</span><span class="w"> </span><span class="mf">0.34875044226646423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15635445713996887</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25805917382240295</span><span class="p">,</span><span class="w"> </span><span class="mf">0.316285640001297</span><span class="p">,</span><span class="w"> </span><span class="mf">0.29047688841819763</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.09108144044876099</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2781231701374054</span><span class="p">,</span><span class="w"> </span><span class="mf">0.21326711773872375</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.29581472277641296</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3105146288871765</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.11265464127063751</span><span class="p">,</span><span class="w"> </span><span class="mf">0.054490894079208374</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.22294805943965912</span><span class="p">,</span><span class="w"> </span><span class="mf">0.23276928067207336</span><span class="p">,</span><span class="w"> </span><span class="mf">0.06426036357879639</span><span class="p">,</span><span class="w"> </span><span class="mf">0.12059605121612549</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.24530324339866638</span><span class="p">,</span><span class="w"> </span><span class="mf">0.061366915702819824</span><span class="p">,</span><span class="w"> </span><span class="mf">0.17463091015815735</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2774006724357605</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2621242105960846</span><span class="p">,</span><span class="w"> </span><span class="mf">0.19262376427650452</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.10884760320186615</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3156566321849823</span><span class="p">,</span><span class="w"> </span><span class="mf">0.104307621717453</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.22591334581375122</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.09672778844833374</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.18450938165187836</span><span class="p" data-group-id="4993553849-10">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-11">[</span><span class="o">-</span><span class="mf">0.32328563928604126</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3434811234474182</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3464450538158417</span><span class="p">,</span><span class="w"> </span><span class="mf">0.14756330847740173</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010595977306365967</span><span class="p">,</span><span class="w"> </span><span class="mf">0.32808688282966614</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3048470616340637</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011142522096633911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.10394474864006042</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04501914978027344</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.26296690106391907</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1051199734210968</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.0060880184173583984</span><span class="p">,</span><span class="w"> </span><span class="mf">0.22103646397590637</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3040429651737213</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="4993553849-11">]</span><span class="p">,</span><span class="w">
        </span><span class="n">...</span><span class="w">
      </span><span class="p" data-group-id="4993553849-9">]</span><span class="w">
    </span><span class="p" data-group-id="4993553849-6">&gt;</span><span class="w">
  </span><span class="p" data-group-id="4993553849-2">}</span><span class="p">,</span><span class="w">
  </span><span class="s">&quot;dense_1&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-12">%{</span><span class="w">
    </span><span class="s">&quot;bias&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-13">#</span><span class="nc" data-group-id="4993553849-13">Nx.Tensor</span><span class="p" data-group-id="4993553849-13">&lt;</span><span class="w">
      </span><span class="n">f32</span><span class="p" data-group-id="4993553849-14">[</span><span class="mi">1</span><span class="p" data-group-id="4993553849-14">]</span><span class="w">
      </span><span class="p" data-group-id="4993553849-15">[</span><span class="mf">0.0</span><span class="p" data-group-id="4993553849-15">]</span><span class="w">
    </span><span class="p" data-group-id="4993553849-13">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="s">&quot;kernel&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4993553849-16">#</span><span class="nc" data-group-id="4993553849-16">Nx.Tensor</span><span class="p" data-group-id="4993553849-16">&lt;</span><span class="w">
      </span><span class="n">f32</span><span class="p" data-group-id="4993553849-17">[</span><span class="mi">32</span><span class="p" data-group-id="4993553849-17">]</span><span class="p" data-group-id="4993553849-18">[</span><span class="mi">1</span><span class="p" data-group-id="4993553849-18">]</span><span class="w">
      </span><span class="p" data-group-id="4993553849-19">[</span><span class="w">
        </span><span class="p" data-group-id="4993553849-20">[</span><span class="o">-</span><span class="mf">0.379288911819458</span><span class="p" data-group-id="4993553849-20">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-21">[</span><span class="o">-</span><span class="mf">0.05532142519950867</span><span class="p" data-group-id="4993553849-21">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-22">[</span><span class="o">-</span><span class="mf">0.07836392521858215</span><span class="p" data-group-id="4993553849-22">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-23">[</span><span class="mf">0.41381680965423584</span><span class="p" data-group-id="4993553849-23">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-24">[</span><span class="mf">0.33221137523651123</span><span class="p" data-group-id="4993553849-24">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-25">[</span><span class="mf">0.23515504598617554</span><span class="p" data-group-id="4993553849-25">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-26">[</span><span class="o">-</span><span class="mf">0.40667685866355896</span><span class="p" data-group-id="4993553849-26">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-27">[</span><span class="o">-</span><span class="mf">0.3503745198249817</span><span class="p" data-group-id="4993553849-27">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-28">[</span><span class="mf">0.2631032466888428</span><span class="p" data-group-id="4993553849-28">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-29">[</span><span class="o">-</span><span class="mf">0.13176566362380981</span><span class="p" data-group-id="4993553849-29">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-30">[</span><span class="o">-</span><span class="mf">0.3811171054840088</span><span class="p" data-group-id="4993553849-30">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-31">[</span><span class="mf">0.24656128883361816</span><span class="p" data-group-id="4993553849-31">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-32">[</span><span class="mf">0.17257028818130493</span><span class="p" data-group-id="4993553849-32">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-33">[</span><span class="mf">0.3528350591659546</span><span class="p" data-group-id="4993553849-33">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-34">[</span><span class="mf">0.4112042784690857</span><span class="p" data-group-id="4993553849-34">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-35">[</span><span class="mf">0.056196123361587524</span><span class="p" data-group-id="4993553849-35">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-36">[</span><span class="mf">0.138421893119812</span><span class="p" data-group-id="4993553849-36">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-37">[</span><span class="o">-</span><span class="mf">0.38378745317459106</span><span class="p" data-group-id="4993553849-37">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-38">[</span><span class="o">-</span><span class="mf">0.044070273637771606</span><span class="p" data-group-id="4993553849-38">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-39">[</span><span class="mf">0.11507803201675415</span><span class="p" data-group-id="4993553849-39">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-40">[</span><span class="o">-</span><span class="mf">0.3125251233577728</span><span class="p" data-group-id="4993553849-40">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-41">[</span><span class="o">-</span><span class="mf">0.11389034986495972</span><span class="p" data-group-id="4993553849-41">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-42">[</span><span class="o">-</span><span class="mf">0.27444711327552795</span><span class="p" data-group-id="4993553849-42">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-43">[</span><span class="o">-</span><span class="mf">0.30974721908569336</span><span class="p" data-group-id="4993553849-43">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-44">[</span><span class="o">-</span><span class="mf">0.3695589303970337</span><span class="p" data-group-id="4993553849-44">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-45">[</span><span class="mf">0.3146793246269226</span><span class="p" data-group-id="4993553849-45">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-46">[</span><span class="mf">0.005854517221450806</span><span class="p" data-group-id="4993553849-46">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-47">[</span><span class="o">-</span><span class="mf">0.03735968470573425</span><span class="p" data-group-id="4993553849-47">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-48">[</span><span class="mf">0.02763468027114868</span><span class="p" data-group-id="4993553849-48">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-49">[</span><span class="o">-</span><span class="mf">0.10707724094390869</span><span class="p" data-group-id="4993553849-49">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-50">[</span><span class="mf">0.10824829339981079</span><span class="p" data-group-id="4993553849-50">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4993553849-51">[</span><span class="mf">0.29013824462890625</span><span class="p" data-group-id="4993553849-51">]</span><span class="w">
      </span><span class="p" data-group-id="4993553849-19">]</span><span class="w">
    </span><span class="p" data-group-id="4993553849-16">&gt;</span><span class="w">
  </span><span class="p" data-group-id="4993553849-12">}</span><span class="w">
</span><span class="p" data-group-id="4993553849-1">}</span></code></pre><p>Wow! Notice that this model actually has trainable parameters. You can see that the parameter map is just a regular Elixir map. Each top-level entry maps to a layer with a key corresponding to that layer's name and a value corresponding to that layer's trainable parameters. Each layer's individual trainable parameters are given layer-specific names and map directly to Nx tensors.</p><p>Now you can use these <code class="inline">params</code> with your <code class="inline">predict_fn</code>:</p><pre><code class="makeup elixir" translate="no"><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="5301437588-1">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">iota</span><span class="p" data-group-id="5301437588-2">(</span><span class="p" data-group-id="5301437588-3">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p" data-group-id="5301437588-3">}</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="5301437588-2">)</span><span class="p" data-group-id="5301437588-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="9052568147-1">#</span><span class="nc" data-group-id="9052568147-1">Nx.Tensor</span><span class="p" data-group-id="9052568147-1">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="9052568147-2">[</span><span class="mi">2</span><span class="p" data-group-id="9052568147-2">]</span><span class="p" data-group-id="9052568147-3">[</span><span class="mi">1</span><span class="p" data-group-id="9052568147-3">]</span><span class="w">
  </span><span class="p" data-group-id="9052568147-4">[</span><span class="w">
    </span><span class="p" data-group-id="9052568147-5">[</span><span class="mf">1.0</span><span class="p" data-group-id="9052568147-5">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9052568147-6">[</span><span class="mf">1.0</span><span class="p" data-group-id="9052568147-6">]</span><span class="w">
  </span><span class="p" data-group-id="9052568147-4">]</span><span class="w">
</span><span class="p" data-group-id="9052568147-1">&gt;</span></code></pre><p>And voila! You've successfully created and used a sequential model in Axon!</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="your_first_axon_model.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Your first Axon model
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="complex_models.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Complex models
        </span>
      </a>

  </div>
</div>
      <footer class="footer">
        <p>

            <span class="line">
              <a href="https://hex.pm/packages/axon/0.3.0" class="footer-hex-package">Hex Package</a>

              <a href="https://preview.hex.pm/preview/axon/0.3.0">Hex Preview</a>

                (<a href="https://preview.hex.pm/preview/axon/0.3.0/show/guides/model_creation/sequential_models.livemd">current file</a>)

            </span>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

              <a href="Axon.epub" title="ePub version">
                Download ePub version
              </a>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.1) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<!-- Render math with KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

<!-- Render diagrams with Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({ startOnLoad: false });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition, function (svgSource, bindListeners) {
        graphEl.innerHTML = svgSource;
        bindListeners && bindListeners(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  });
</script>

  </body>
</html>
